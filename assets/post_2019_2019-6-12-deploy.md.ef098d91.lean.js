import{o as n,c as e,f as s,a,x as t}from"./app.5f3fb606.js";const l='{"title":"持续集成与持续部署","description":"","frontmatter":{"title":"持续集成与持续部署","tag":["circleCI","jenkins","travisCI"],"author":"Artiely","date":"2019-6-12","cover":"https://gitee.com/artiely/Figure-bed/raw/master/images/20200315152754.png","base64":"f8f8f8"},"headers":[{"level":2,"title":"介绍","slug":"介绍"},{"level":2,"title":"持续集成","slug":"持续集成"},{"level":3,"title":"核心概念","slug":"核心概念"},{"level":3,"title":"持续集成组成要素","slug":"持续集成组成要素"},{"level":3,"title":"应用场景","slug":"应用场景"},{"level":3,"title":"工作流","slug":"工作流"},{"level":3,"title":"效率工具对比","slug":"效率工具对比"},{"level":2,"title":"Jenkins","slug":"jenkins"},{"level":3,"title":"使用简介","slug":"使用简介"},{"level":3,"title":"安装方式","slug":"安装方式"},{"level":3,"title":"插件介绍","slug":"插件介绍"},{"level":3,"title":"配置自动化任务","slug":"配置自动化任务"},{"level":3,"title":"前端项目中的应用","slug":"前端项目中的应用"},{"level":2,"title":"TravisCI","slug":"travisci"},{"level":3,"title":"使用简介","slug":"使用简介-1"},{"level":3,"title":"配置Node.js应用","slug":"配置nodejs应用"},{"level":2,"title":"CircleCI","slug":"circleci"},{"level":3,"title":"使用简介","slug":"使用简介-2"},{"level":3,"title":"配置Node.js应用","slug":"配置nodejs应用-1"},{"level":2,"title":"扩展知识","slug":"扩展知识"},{"level":3,"title":"自动化流程的发展趋势","slug":"自动化流程的发展趋势"},{"level":3,"title":"复杂的DevOps相关工具","slug":"复杂的devops相关工具"},{"level":3,"title":"Jenkins的一些应用场景","slug":"jenkins的一些应用场景"},{"level":3,"title":"Jenkins的Docker-compose.yml创建文件","slug":"jenkins的docker-composeyml创建文件"},{"level":3,"title":"gitlab的docker启动配置文件","slug":"gitlab的docker启动配置文件"}],"relativePath":"post/2019/2019-6-12-deploy.md","lastUpdated":1629110829254}',c={},o=s('',113),i=a("ol",null,[a("li",null,[a("p",null,"环境要求"),a("ul",null,[a("li",null,[t("机器要求： "),a("ul",null,[a("li",null,"256 MB 内存，建议大于 512 MB"),a("li",null,"10 GB 的硬盘空间（用于 Jenkins 和 Docker 镜像）")])]),a("li",null,[t("需要安装以下软件： "),a("ul",null,[a("li",null,"Java 8 ( JRE 或者 JDK 都可以)"),a("li",null,[a("a",{href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"},"Docker"),t(" （导航到网站顶部的Get Docker链接以访问适合您平台的Docker下载）")])])])])]),a("li",null,[a("p",null,"常规安装"),a("ul",null,[a("li",null,[a("p",null,"安装JDK"),a("p",null,[a("a",{href:"https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html",target:"_blank",rel:"noopener noreferrer"},"官方地址")]),a("p",null,"下载对应的操作系统的JDK，然后解压进行安装。以Linux为例："),a("p",null,"下载最新版本，上传到Linux服务器"),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token comment"},"# 上传到 /opt/jdk8目录下"),t("\n\n"),a("span",{class:"token comment"},"# tar解压JDK安装包"),t("\n"),a("span",{class:"token function"},"mkdir"),t(" -p /opt/jdk8\n"),a("span",{class:"token function"},"tar"),t(" zxvf jdk-8u211-linux-x64.tar.gz -C /opt/jdk8 --strip-components "),a("span",{class:"token number"},"1"),t("\n\n"),a("span",{class:"token comment"},"# vi /etc/profile"),t("\n"),a("span",{class:"token builtin class-name"},"export"),t(),a("span",{class:"token assign-left variable"},"JAVA_HOME"),a("span",{class:"token operator"},"="),t("/opt/jdk8\n"),a("span",{class:"token builtin class-name"},"export"),t(),a("span",{class:"token assign-left variable"},"JRE_HOME"),a("span",{class:"token operator"},"="),a("span",{class:"token variable"},"${JAVA_HOME}"),t("/jre\n"),a("span",{class:"token builtin class-name"},"export"),t(),a("span",{class:"token assign-left variable"},"CLASSPATH"),a("span",{class:"token operator"},"="),t(".:"),a("span",{class:"token variable"},"${JAVA_HOME}"),t("/lib:"),a("span",{class:"token variable"},"${JRE_HOME}"),t("/lib\n"),a("span",{class:"token builtin class-name"},"export"),t(),a("span",{class:"token assign-left variable"},[a("span",{class:"token environment constant"},"PATH")]),a("span",{class:"token operator"},"="),a("span",{class:"token variable"},"${JAVA_HOME}"),t("/bin:"),a("span",{class:"token environment constant"},"$PATH"),t("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991834-7702"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"# 上传到 /opt/jdk8目录下\n\n# tar解压JDK安装包\nmkdir -p /opt/jdk8\ntar zxvf jdk-8u211-linux-x64.tar.gz -C /opt/jdk8 --strip-components 1\n\n# vi /etc/profile\nexport JAVA_HOME=/opt/jdk8\nexport JRE_HOME=${JAVA_HOME}/jre\nexport CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib\nexport PATH=${JAVA_HOME}/bin:$PATH\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991834-7702","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br")])])]),a("li",null,[a("p",null,"安装Jenkins"),a("p",null,[t("下载Jenkins最新的war包："),a("a",{href:"http://mirrors.jenkins.io/war-stable/latest/jenkins.war",target:"_blank",rel:"noopener noreferrer"},"Latest")]),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token function"},"mkdir"),t(" -p /opt/jenkins "),a("span",{class:"token operator"},"&&"),t(),a("span",{class:"token builtin class-name"},"cd"),t(" /opt/jenkins\n\n"),a("span",{class:"token function"},"wget"),t(" -O /opt/jenkins/jenkins.war http://mirrors.jenkins.io/war-stable/latest/jenkins.war\n\njava -jar jenkins.war --httpPort"),a("span",{class:"token operator"},"="),a("span",{class:"token number"},"8080"),t("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991834-96789"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"mkdir -p /opt/jenkins && cd /opt/jenkins\n\nwget -O /opt/jenkins/jenkins.war http://mirrors.jenkins.io/war-stable/latest/jenkins.war\n\njava -jar jenkins.war --httpPort=8080\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991834-96789","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br")])]),a("p",null,"就嗯可以打开，http://localhost:8080了"),a("p",null,"注意一段这样的话："),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,"*************************************************************\n*************************************************************\n*************************************************************\n\nJenkins initial setup is required. An admin user has been created and a password generated.\nPlease use the following password to proceed to installation:\n\n63196690ae7d47c49506480ee0e1af4a\n\nThis may also be found at: /root/.jenkins/secrets/initialAdminPassword\n\n*************************************************************\n*************************************************************\n*************************************************************\n"),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991834-38217"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"*************************************************************\n*************************************************************\n*************************************************************\n\nJenkins initial setup is required. An admin user has been created and a password generated.\nPlease use the following password to proceed to installation:\n\n63196690ae7d47c49506480ee0e1af4a\n\nThis may also be found at: /root/.jenkins/secrets/initialAdminPassword\n\n*************************************************************\n*************************************************************\n*************************************************************\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991834-38217","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br")])]),a("p",null,[t("这里的"),a("code",null,"63196690ae7d47c49506480ee0e1af4a"),t("就是初始的安装的管理员密码。")])])])]),a("li",null,[a("p",null,"使用Docker安装"),a("ul",null,[a("li",null,[a("p",null,"安装Docker"),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token comment"},"# From https://get.docker.com:"),t("\n"),a("span",{class:"token function"},"curl"),t(" -fsSL https://get.docker.com -o get-docker.sh\n"),a("span",{class:"token function"},"sh"),t(" get-docker.sh\n\n"),a("span",{class:"token comment"},"#From https://test.docker.com:"),t("\n"),a("span",{class:"token function"},"curl"),t(" -fsSL https://test.docker.com -o test-docker.sh\n"),a("span",{class:"token function"},"sh"),t(" test-docker.sh\n\n"),a("span",{class:"token comment"},"# From the source repo (This will install latest from the test channel):"),t("\n"),a("span",{class:"token function"},"sh"),t(" install.sh\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991834-1918"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"# From https://get.docker.com:\ncurl -fsSL https://get.docker.com -o get-docker.sh\nsh get-docker.sh\n\n#From https://test.docker.com:\ncurl -fsSL https://test.docker.com -o test-docker.sh\nsh test-docker.sh\n\n# From the source repo (This will install latest from the test channel):\nsh install.sh\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991834-1918","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br")])])]),a("li",null,[a("p",null,[t("配置Docker镜像加速，使用阿里云"),a("a",{href:"https://cr.console.aliyun.com/?spm=a2c4e.11153940.blogcont29941.9.52027e29w2jv9P",target:"_blank",rel:"noopener noreferrer"},"容器加速服务")]),a("p",null,"左侧的加速器帮助页面就会显示为你独立分配的加速地址"),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[t("例如：\n公网Mirror："),a("span",{class:"token punctuation"},"["),t("系统分配前缀"),a("span",{class:"token punctuation"},"]"),t(".mirror.aliyuncs.com\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991834-59812"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"例如：\n公网Mirror：[系统分配前缀].mirror.aliyuncs.com\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991834-59812","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br")])]),a("p",null,[t("使用配置文件 "),a("code",null,"/etc/docker/daemon.json"),t("（没有时新建该文件）")]),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token punctuation"},"{"),t("\n    "),a("span",{class:"token string"},'"registry-mirrors"'),a("span",{class:"token builtin class-name"},":"),t(),a("span",{class:"token punctuation"},"["),a("span",{class:"token string"},'"<your accelerate address>"'),a("span",{class:"token punctuation"},"]"),t("\n"),a("span",{class:"token punctuation"},"}"),t("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991834-77494"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'{\n    "registry-mirrors": ["<your accelerate address>"]\n}\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991834-77494","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br")])]),a("p",null,"重启Docker Daemon就可以了"),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,"systemctl daemon-reload\nsystemctl restart docker\n"),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991834-19733"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"systemctl daemon-reload\nsystemctl restart docker\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991834-19733","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br")])]),a("p",null,[a("code",null,"docker ps"),t(" 查看容器运行状态")]),a("p",null,[a("code",null,"docker logs 容器ID/容器名称"),t(" 查看管理员初始密码")])]),a("li",null,[a("p",null,"安装Docker-compose.yml文件(可选)"),a("p",null,[a("strong",null,"安装方法：")]),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token comment"},"#下载"),t("\n"),a("span",{class:"token function"},"sudo"),t(),a("span",{class:"token function"},"curl"),t(" -L https://github.com/docker/compose/releases/download/1.20.0/docker-compose-"),a("span",{class:"token variable"},[a("span",{class:"token variable"},"`"),a("span",{class:"token function"},"uname"),t(" -s"),a("span",{class:"token variable"},"`")]),t("-"),a("span",{class:"token variable"},[a("span",{class:"token variable"},"`"),a("span",{class:"token function"},"uname"),t(" -m"),a("span",{class:"token variable"},"`")]),t(" -o /usr/local/bin/docker-compose\n"),a("span",{class:"token comment"},"#安装"),t("\n"),a("span",{class:"token function"},"chmod"),t(" +x /usr/local/bin/docker-compose\n"),a("span",{class:"token comment"},"#查看版本"),t("\ndocker-compose --version\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991834-27922"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"#下载\nsudo curl -L https://github.com/docker/compose/releases/download/1.20.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose\n#安装\nchmod +x /usr/local/bin/docker-compose\n#查看版本\ndocker-compose --version\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991834-27922","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br")])])]),a("li",null,[a("p",null,"安装Jenkins"),a("p",null,[a("strong",null,"版本选择：")]),a("p",null,[t("Jenkins: "),a("a",{href:"https://hub.docker.com/r/jenkins/jenkins/",target:"_blank",rel:"noopener noreferrer"},"https://hub.docker.com/r/jenkins/jenkins/")]),a("p",null,[t("Jenkins with Blue Ocean: "),a("a",{href:"https://hub.docker.com/r/jenkinsci/blueocean",target:"_blank",rel:"noopener noreferrer"},"https://hub.docker.com/r/jenkinsci/blueocean")]),a("blockquote",null,[a("p",null,[t("Blue Ocean 重新思考Jenkins的用户体验，从头开始设计"),a("a",{href:"https://jenkins.io/zh/doc/book/pipeline/",target:"_blank",rel:"noopener noreferrer"},"Jenkins Pipeline"),t(", 但仍然与自由式作业兼容，Blue Ocean减少了混乱而且进一步明确了团队中每个成员 Blue Ocean 的主要特性包括：")]),a("ul",null,[a("li",null,[t("持续交付(CD)Pipeline的 "),a("strong",null,"复杂可视化"),t(" ，可以让您快速直观地理解管道状态。")]),a("li",null,[a("strong",null,"Pipeline 编辑器"),t(" - 引导用户通过直观的、可视化的过程来创建Pipeline，从而使Pipeline的创建变得平易近人。")]),a("li",null,[a("strong",null,"个性化"),t(" 以适应团队中每个成员不同角色的需求。")]),a("li",null,[t("在需要干预和/或出现问题时 "),a("strong",null,"精确定位"),t(" 。 Blue Ocean 展示 Pipeline中需要关注的地方， 简化异常处理，提高生产力")]),a("li",null,[a("strong",null,"本地集成分支和合并请求"),t(", 在与GitHub 和 Bitbucket中的其他人协作编码时实现最大程度的开发人员生产力。****")])])]),a("p",null,[a("strong",null,"安装命令：")]),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token comment"},"# Jenkins"),t("\ndocker run "),a("span",{class:"token punctuation"},"\\"),t("\n  -itd "),a("span",{class:"token punctuation"},"\\"),t("\n  -u root "),a("span",{class:"token punctuation"},"\\"),t("\n  -p "),a("span",{class:"token number"},"8080"),t(":8080 "),a("span",{class:"token punctuation"},"\\"),t("\n  -v jenkins-data:/var/jenkins_home "),a("span",{class:"token punctuation"},"\\"),t("\n  -v /var/run/docker.sock:/var/run/docker.sock "),a("span",{class:"token punctuation"},"\\"),t("\n  -v /usr/bin/docker:/usr/bin/docker "),a("span",{class:"token punctuation"},"\\"),t("\n  --name jenkins-master "),a("span",{class:"token punctuation"},"\\"),t("\n  jenkins/jenkins\n  \n"),a("span",{class:"token comment"},"# Jenkins blueocean"),t("\ndocker run "),a("span",{class:"token punctuation"},"\\"),t("\n  -itd "),a("span",{class:"token punctuation"},"\\"),t("\n  -u root "),a("span",{class:"token punctuation"},"\\"),t("\n  -p "),a("span",{class:"token number"},"8080"),t(":8080 "),a("span",{class:"token punctuation"},"\\"),t("\n  -v jenkins-data:/var/jenkins_home "),a("span",{class:"token punctuation"},"\\"),t(" \n  -v /var/run/docker.sock:/var/run/docker.sock "),a("span",{class:"token punctuation"},"\\"),t("\n  -v /usr/bin/docker:/usr/bin/docker "),a("span",{class:"token punctuation"},"\\"),t("\n  --name jenkins-master "),a("span",{class:"token punctuation"},"\\"),t("\n  jenkinsci/blueocean\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991834-65734"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"# Jenkins\ndocker run \\\n  -itd \\\n  -u root \\\n  -p 8080:8080 \\\n  -v jenkins-data:/var/jenkins_home \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v /usr/bin/docker:/usr/bin/docker \\\n  --name jenkins-master \\\n  jenkins/jenkins\n  \n# Jenkins blueocean\ndocker run \\\n  -itd \\\n  -u root \\\n  -p 8080:8080 \\\n  -v jenkins-data:/var/jenkins_home \\ \n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v /usr/bin/docker:/usr/bin/docker \\\n  --name jenkins-master \\\n  jenkinsci/blueocean\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991834-65734","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br")])])])])]),a("li",null,[a("p",null,"配置Jenkins插件加速"),a("p",null,"进入jenkins系统管理->插件管理中->高级选项卡->升级站点，使用清华源："),a("div",{class:"language-html line-numbers-mode"},[a("pre",null,[a("code",null,"https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/current/update-center.json\n"),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991835-67481"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/current/update-center.json\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991835-67481","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br")])]),a("p",null,[a("img",{src:"https://gitee.com/artiely/Figure-bed/raw/master/images/20200310114330.png",alt:"ç³»ç»ç®¡ç"})]),a("p",null,[a("img",{src:"https://gitee.com/artiely/Figure-bed/raw/master/images/20200310114331.jpeg",alt:"æä»¶ç®¡ç"})]),a("p",null,"关于官方所有的镜像列表："),a("p",null,[a("a",{href:"http://mirrors.jenkins-ci.org/status.html",target:"_blank",rel:"noopener noreferrer"},"http://mirrors.jenkins-ci.org/status.html")])]),a("li",null,[a("p",null,"环境配置"),a("ul",null,[a("li",null,"Jenkins 的URL路径"),a("li",null,"全局工具的配置：Docker, JDK(JAVA)...")])]),a("li",null,[a("p",null,"用户权限配置"),a("ul",null,[a("li",null,"矩阵权限的配置"),a("li",null,"添加管理员用户所有的权限"),a("li",null,[t("添加"),a("a",{href:"https://wiki.jenkins-ci.org/display/JENKINS/Authorize+Project+plugin",target:"_blank",rel:"noopener noreferrer"},"Authorize Project"),t("插件，并且在系统管理中进行配置。配置逻辑，就给用户当前项目的矩阵权限！")])])]),a("li",null,[a("p",null,"与gitlab进行联接"),a("ul",null,[a("li",null,"设置一个SSH Key，方便Jenkins去拉取Gitlab中的项目"),a("li",null,[t("GItlab项目中去配置SSH Key的Deploy权限。"),a("code",null,"Settings -> Repository -> Deploy keys -> Public Deploy Keys")]),a("li",null,"Jenkins添加SSH的私钥")]),a("p",null,"这样就完成了Jenkins可以访问gitlab的联接的过程。"),a("p",null,"Jenkins层面，需要去安装Gitlab相关插件。")])],-1),r=s('',29),p=a("ul",null,[a("li",null,[a("p",null,"nodejs插件"),a("p",null,"主要是用于不同版本的Node打包"),a("p",null,[t("特别需要注意的是，使用"),a("code",null,"jenkinsci/blueocean"),t("镜像的，需要重新运行新的容器，以便nodejs插件生效。")]),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[t("docker run "),a("span",{class:"token punctuation"},"\\"),t("\n  -itd "),a("span",{class:"token punctuation"},"\\"),t("\n  -u root "),a("span",{class:"token punctuation"},"\\"),t("\n  -p "),a("span",{class:"token number"},"8080"),t(":8080 "),a("span",{class:"token punctuation"},"\\"),t("\n  -v /var/jenkins_home:/var/jenkins_home "),a("span",{class:"token punctuation"},"\\"),t("\n  -v /var/run/docker.sock:/var/run/docker.sock "),a("span",{class:"token punctuation"},"\\"),t("\n  -v /usr/bin/docker:/usr/bin/docker "),a("span",{class:"token punctuation"},"\\"),t("\n  --name jenkins-master "),a("span",{class:"token punctuation"},"\\"),t("\n  jenkins/jenkins\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991835-74944"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"docker run \\\n  -itd \\\n  -u root \\\n  -p 8080:8080 \\\n  -v /var/jenkins_home:/var/jenkins_home \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v /usr/bin/docker:/usr/bin/docker \\\n  --name jenkins-master \\\n  jenkins/jenkins\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991835-74944","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br")])]),a("p",null,[t("注意："),a("code",null,"docker stop 容器名称"),t(" 去停止之前的容器！")])]),a("li",null,[a("p",null,"Publish Over SSH"),a("p",null,"用于构建完成之后，推送到远程的web服务器")])],-1),u=a("p",null,"Jenkins发布到Nginx Docker容器：",-1),d=a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token comment"},"# !bin/bash"),t("\nnode -v\ncnpm "),a("span",{class:"token function"},"install"),t("\n"),a("span",{class:"token function"},"npm"),t(" run build\n"),a("span",{class:"token function"},"ls"),t(" -la\n"),a("span",{class:"token keyword"},"if"),t(),a("span",{class:"token punctuation"},"["),t(),a("span",{class:"token string"},[t('"'),a("span",{class:"token variable"},[a("span",{class:"token variable"},"$("),t("docker inspect -f "),a("span",{class:"token string"},"'{{.State.Running}}'"),t(" nginx"),a("span",{class:"token variable"},")")]),t('"')]),t(),a("span",{class:"token operator"},"="),t(),a("span",{class:"token string"},'"true"'),t(),a("span",{class:"token punctuation"},"]"),a("span",{class:"token punctuation"},";"),t(),a("span",{class:"token keyword"},"then"),t("\n\tdocker stop nginx "),a("span",{class:"token operator"},"&&"),t(" docker "),a("span",{class:"token function"},"rm"),t(" nginx"),a("span",{class:"token punctuation"},";"),t("\n"),a("span",{class:"token keyword"},"fi"),t("\n\ndocker run -itd --name nginx -v "),a("span",{class:"token variable"},[a("span",{class:"token variable"},"`"),a("span",{class:"token builtin class-name"},"pwd"),a("span",{class:"token variable"},"`")]),t("/dist:/usr/share/nginx/html -p "),a("span",{class:"token number"},"20000"),t(":80 nginx\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991835-70363"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'# !bin/bash\nnode -v\ncnpm install\nnpm run build\nls -la\nif [ "$(docker inspect -f \'{{.State.Running}}\' nginx)" = "true" ]; then\n\tdocker stop nginx && docker rm nginx;\nfi\n\ndocker run -itd --name nginx -v `pwd`/dist:/usr/share/nginx/html -p 20000:80 nginx\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991835-70363","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br")])],-1),m=a("p",null,"Pipleline演示：",-1),b=a("div",{class:"language-yaml line-numbers-mode"},[a("pre",null,[a("code",null,[t("pipeline "),a("span",{class:"token punctuation"},"{"),t("\n  agent "),a("span",{class:"token punctuation"},"{"),t("\n    docker "),a("span",{class:"token punctuation"},"{"),t("\n      image 'node"),a("span",{class:"token punctuation"},":"),t("10'\n      args '"),a("span",{class:"token punctuation"},"-"),t("p 20000"),a("span",{class:"token punctuation"},":"),t("8080'\n    "),a("span",{class:"token punctuation"},"}"),t("\n\n  "),a("span",{class:"token punctuation"},"}"),t("\n  stages "),a("span",{class:"token punctuation"},"{"),t("\n    stage('Build') "),a("span",{class:"token punctuation"},"{"),t("\n      steps "),a("span",{class:"token punctuation"},"{"),t("\n        sh 'yarn install'\n      "),a("span",{class:"token punctuation"},"}"),t("\n    "),a("span",{class:"token punctuation"},"}"),t("\n    stage('Deploy') "),a("span",{class:"token punctuation"},"{"),t("\n      steps "),a("span",{class:"token punctuation"},"{"),t("\n        sh './scripts/deploy.sh'\n        input 'Finished using the web site"),a("span",{class:"token punctuation"},"?"),t(" (Click \"Proceed\" to continue)'\n        sh './scripts/kill.sh'\n      "),a("span",{class:"token punctuation"},"}"),t("\n    "),a("span",{class:"token punctuation"},"}"),t("\n  "),a("span",{class:"token punctuation"},"}"),t("\n"),a("span",{class:"token punctuation"},"}"),t("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991835-27895"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"pipeline {\n  agent {\n    docker {\n      image 'node:10'\n      args '-p 20000:8080'\n    }\n\n  }\n  stages {\n    stage('Build') {\n      steps {\n        sh 'yarn install'\n      }\n    }\n    stage('Deploy') {\n      steps {\n        sh './scripts/deploy.sh'\n        input 'Finished using the web site? (Click \"Proceed\" to continue)'\n        sh './scripts/kill.sh'\n      }\n    }\n  }\n}\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991835-27895","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br")])],-1),k=a("p",null,[a("code",null,"deploy.sh"),t("文件")],-1),y=a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token shebang important"},"#!/usr/bin/env sh"),t("\n"),a("span",{class:"token builtin class-name"},"set"),t(" -x\n"),a("span",{class:"token function"},"npm"),t(" run serve "),a("span",{class:"token operator"},"&"),t("\n"),a("span",{class:"token function"},"sleep"),t(),a("span",{class:"token number"},"1"),t("\n"),a("span",{class:"token builtin class-name"},"echo"),t(),a("span",{class:"token variable"},"$!"),t(),a("span",{class:"token operator"},">"),t(" .pidfile\n"),a("span",{class:"token builtin class-name"},"set"),t(" +x\n\n"),a("span",{class:"token builtin class-name"},"echo"),t(),a("span",{class:"token string"},"'Now...'"),t("\n"),a("span",{class:"token builtin class-name"},"echo"),t(),a("span",{class:"token string"},"'Visit http://localhost:8080 to see your Node.js/Vue application in action.'"),t("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991840-50137"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"#!/usr/bin/env sh\nset -x\nnpm run serve &\nsleep 1\necho $! > .pidfile\nset +x\n\necho 'Now...'\necho 'Visit http://localhost:8080 to see your Node.js/Vue application in action.'\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991840-50137","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br")])],-1),h=s("",4),g=a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token shebang important"},"#!/usr/bin/env sh"),t("\n\n"),a("span",{class:"token builtin class-name"},"echo"),t(),a("span",{class:"token string"},"'The following command terminates the \"npm run serve\" process using its PID'"),t("\n"),a("span",{class:"token builtin class-name"},"echo"),t(),a("span",{class:"token string"},'\'(written to ".pidfile"), all of which were conducted when "deloy.sh"\''),t("\n"),a("span",{class:"token builtin class-name"},"echo"),t(),a("span",{class:"token string"},"'was executed.'"),t("\n"),a("span",{class:"token builtin class-name"},"set"),t(" -x\n"),a("span",{class:"token function"},"kill"),t(),a("span",{class:"token variable"},[a("span",{class:"token variable"},"$("),a("span",{class:"token function"},"cat"),t(" .pidfile"),a("span",{class:"token variable"},")")]),t("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991840-80824"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"#!/usr/bin/env sh\n\necho 'The following command terminates the \"npm run serve\" process using its PID'\necho '(written to \".pidfile\"), all of which were conducted when \"deloy.sh\"'\necho 'was executed.'\nset -x\nkill $(cat .pidfile)\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991840-80824","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br")])],-1),_=s('',23),f=a("ul",null,[a("li",null,[a("p",null,"设置项目语言"),a("div",{class:"language-yaml line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token key atrule"},"language"),a("span",{class:"token punctuation"},":"),t(" node_js\n"),a("span",{class:"token key atrule"},"node_js"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token string"},'"10"'),t("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991840-38593"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'language: node_js\nnode_js:\n  - "10"\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991840-38593","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br")])])]),a("li",null,[a("p",null,"Script脚本"),a("p",null,"Travis 的运行流程很简单，任何项目都会经过两个阶段。"),a("blockquote",null,[a("ul",null,[a("li",null,"install 阶段：安装依赖"),a("li",null,"script 阶段：运行脚本")])]),a("p",null,"配置文件："),a("div",{class:"language-yaml line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token comment"},"# S: Build Lifecycle"),t("\n"),a("span",{class:"token key atrule"},"install"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token punctuation"},"-"),t(" yarn install\n\n// 钩子方法\n"),a("span",{class:"token key atrule"},"before_script"),a("span",{class:"token punctuation"},":"),t("\n\n"),a("span",{class:"token comment"},"# 无其他依赖项所以执行npm run build 构建就行了"),t("\n"),a("span",{class:"token key atrule"},"script"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token punctuation"},"-"),t(" npm run build\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991841-22404"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"# S: Build Lifecycle\ninstall:\n  - yarn install\n\n// 钩子方法\nbefore_script:\n\n# 无其他依赖项所以执行npm run build 构建就行了\nscript:\n  - npm run build\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991841-22404","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br")])]),a("p",null,[t("如果不需要安装，即跳过安装阶段，就直接设为"),a("code",null,"true"),t("。")]),a("div",{class:"language-javascript line-numbers-mode"},[a("pre",null,[a("code",null,[t("install"),a("span",{class:"token operator"},":"),t(),a("span",{class:"token boolean"},"true"),t("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991841-70071"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"install: true\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991841-70071","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br")])]),a("p",null,[a("code",null,"script"),t("字段用来指定构建或测试脚本。")]),a("div",{class:"language-javascript line-numbers-mode"},[a("pre",null,[a("code",null,[t("script"),a("span",{class:"token operator"},":"),t(" bundle exec thor build\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991841-9669"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"script: bundle exec thor build\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991841-9669","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br")])]),a("p",null,"如果有多个脚本，可以写成下面的形式。"),a("div",{class:"language-javascript line-numbers-mode"},[a("pre",null,[a("code",null,[t("script"),a("span",{class:"token operator"},":"),t("\n  "),a("span",{class:"token operator"},"-"),t(" command1\n  "),a("span",{class:"token operator"},"-"),t(" command2\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991841-60702"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"script:\n  - command1\n  - command2\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991841-60702","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br")])])]),a("li",null,[a("p",null,"部署到github pages"),a("div",{class:"language-yaml line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token key atrule"},"deploy"),a("span",{class:"token punctuation"},":"),t("\n\t"),a("span",{class:"token comment"},"# 其他的一些配置项，可以参考：https://docs.travis-ci.com/user/deployment/pages/"),t("\n  "),a("span",{class:"token key atrule"},"provider"),a("span",{class:"token punctuation"},":"),t(" pages\n  "),a("span",{class:"token key atrule"},"skip_cleanup"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token boolean important"},"true"),t("\n  "),a("span",{class:"token key atrule"},"local_dir"),a("span",{class:"token punctuation"},":"),t(" dist/\n  "),a("span",{class:"token key atrule"},"github_token"),a("span",{class:"token punctuation"},":"),t(" $GITHUB_TOKEN "),a("span",{class:"token comment"},"# Set in the settings page of your repository, as a secure variable"),t("\n  "),a("span",{class:"token key atrule"},"keep_history"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token boolean important"},"false"),t("\n  "),a("span",{class:"token key atrule"},"on"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token key atrule"},"branch"),a("span",{class:"token punctuation"},":"),t(" master\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991841-32942"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"deploy:\n\t# 其他的一些配置项，可以参考：https://docs.travis-ci.com/user/deployment/pages/\n  provider: pages\n  skip_cleanup: true\n  local_dir: dist/\n  github_token: $GITHUB_TOKEN # Set in the settings page of your repository, as a secure variable\n  keep_history: false\n  on:\n    branch: master\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991841-32942","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br")])])]),a("li",null,[a("p",null,"钩子用法"),a("p",null,"Travis 为上面这些阶段提供了7个钩子。"),a("ul",null,[a("li",null,"before_install：install 阶段之前执行"),a("li",null,"before_script：script 阶段之前执行"),a("li",null,"after_failure：script 阶段失败时执行"),a("li",null,"after_success：script 阶段成功时执行"),a("li",null,"before_deploy：deploy 步骤之前执行"),a("li",null,"after_deploy：deploy 步骤之后执行"),a("li",null,"after_script：script 阶段之后执行")]),a("p",null,"完整的生命周期，从开始到结束是下面的流程。"),a("ol",null,[a("li",null,"before_install"),a("li",null,"install"),a("li",null,"before_script"),a("li",null,"script"),a("li",null,[t("after"),a("em",null,"success or after"),t("failure")]),a("li",null,"[OPTIONAL] before_deploy"),a("li",null,"[OPTIONAL] deploy"),a("li",null,"[OPTIONAL] after_deploy"),a("li",null,"after_script")])])],-1),T=s('',5),v=a("div",{class:"language-yaml line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token key atrule"},"language"),a("span",{class:"token punctuation"},":"),t(" node_js\n"),a("span",{class:"token key atrule"},"node_js"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token string"},'"10"'),t("\n\n"),a("span",{class:"token comment"},"# Travis-CI Caching"),t("\n"),a("span",{class:"token key atrule"},"cache"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token key atrule"},"directories"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token punctuation"},"-"),t(" node_modules\n\n"),a("span",{class:"token comment"},"# S: Build Lifecycle"),t("\n"),a("span",{class:"token key atrule"},"install"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token punctuation"},"-"),t(" yarn install\n\n"),a("span",{class:"token key atrule"},"before_script"),a("span",{class:"token punctuation"},":"),t("\n\n"),a("span",{class:"token comment"},"# 无其他依赖项所以执行npm run build 构建就行了"),t("\n"),a("span",{class:"token key atrule"},"script"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token punctuation"},"-"),t(" npm run build\n\n"),a("span",{class:"token key atrule"},"deploy"),a("span",{class:"token punctuation"},":"),t("\n\t"),a("span",{class:"token comment"},"# 其他的一些配置项，可以参考：https://docs.travis-ci.com/user/deployment/pages/"),t("\n  "),a("span",{class:"token key atrule"},"provider"),a("span",{class:"token punctuation"},":"),t(" pages\n  "),a("span",{class:"token key atrule"},"skip_cleanup"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token boolean important"},"true"),t("\n  "),a("span",{class:"token key atrule"},"local_dir"),a("span",{class:"token punctuation"},":"),t(" dist/\n  "),a("span",{class:"token key atrule"},"github_token"),a("span",{class:"token punctuation"},":"),t(" $GITHUB_TOKEN "),a("span",{class:"token comment"},"# Set in the settings page of your repository, as a secure variable"),t("\n  "),a("span",{class:"token key atrule"},"keep_history"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token boolean important"},"false"),t("\n  "),a("span",{class:"token key atrule"},"on"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token key atrule"},"branch"),a("span",{class:"token punctuation"},":"),t(" master\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991842-10240"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'language: node_js\nnode_js:\n  - "10"\n\n# Travis-CI Caching\ncache:\n  directories:\n    - node_modules\n\n# S: Build Lifecycle\ninstall:\n  - yarn install\n\nbefore_script:\n\n# 无其他依赖项所以执行npm run build 构建就行了\nscript:\n  - npm run build\n\ndeploy:\n\t# 其他的一些配置项，可以参考：https://docs.travis-ci.com/user/deployment/pages/\n  provider: pages\n  skip_cleanup: true\n  local_dir: dist/\n  github_token: $GITHUB_TOKEN # Set in the settings page of your repository, as a secure variable\n  keep_history: false\n  on:\n    branch: master\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991842-10240","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br"),a("span",{class:"line-number"},"27"),a("br"),a("span",{class:"line-number"},"28"),a("br")])],-1),A=s('',5),C=a("ol",{start:"3"},[a("li",null,[a("p",null,"编写 config.yml"),a("div",{class:"language-yaml line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token key atrule"},"version"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token number"},"2"),t("\n"),a("span",{class:"token key atrule"},"jobs"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token key atrule"},"build"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token key atrule"},"docker"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"..."),t("\n    "),a("span",{class:"token key atrule"},"branches"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"..."),t("\n    "),a("span",{class:"token key atrule"},"steps"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"..."),t("\n\t\t"),a("span",{class:"token key atrule"},"environment"),a("span",{class:"token punctuation"},":"),t("\n\t\t\t"),a("span",{class:"token punctuation"},"..."),t("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991842-85219"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"version: 2\njobs:\n  build:\n    docker:\n      ...\n    branches:\n      ...\n    steps:\n      ...\n\t\tenvironment:\n\t\t\t...\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991842-85219","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br")])]),a("p",null,[t("官方参考文档："),a("a",{href:"https://circleci.com/docs/2.0/configuration-reference/#version",target:"_blank",rel:"noopener noreferrer"},"https://circleci.com/docs/2.0/configuration-reference/#version")]),a("p",null,"来看一个完事版的配置"),a("div",{class:"language-yaml line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token key atrule"},"version"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token number"},"2"),t("\n"),a("span",{class:"token key atrule"},"jobs"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token key atrule"},"build"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token key atrule"},"docker"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"image"),a("span",{class:"token punctuation"},":"),t(" ubuntu"),a("span",{class:"token punctuation"},":"),a("span",{class:"token number"},"14.04"),t("\n\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"image"),a("span",{class:"token punctuation"},":"),t(" mongo"),a("span",{class:"token punctuation"},":"),t("2.6.8\n        "),a("span",{class:"token key atrule"},"command"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token punctuation"},"["),t("mongod"),a("span",{class:"token punctuation"},","),t(),a("span",{class:"token punctuation"},"-"),a("span",{class:"token punctuation"},"-"),t("smallfiles"),a("span",{class:"token punctuation"},"]"),t("\n\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"image"),a("span",{class:"token punctuation"},":"),t(" postgres"),a("span",{class:"token punctuation"},":"),t("9.4.1\n        "),a("span",{class:"token comment"},"# some containers require setting environment variables"),t("\n        "),a("span",{class:"token key atrule"},"environment"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"POSTGRES_USER"),a("span",{class:"token punctuation"},":"),t(" root\n\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"image"),a("span",{class:"token punctuation"},":"),t(" redis@sha256"),a("span",{class:"token punctuation"},":"),t("54057dd7e125ca41afe526a877e8bd35ec2cdd33b9217e022ed37bdcf7d09673\n\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"image"),a("span",{class:"token punctuation"},":"),t(" rabbitmq"),a("span",{class:"token punctuation"},":"),t("3.5.4\n\n    "),a("span",{class:"token key atrule"},"environment"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token key atrule"},"TEST_REPORTS"),a("span",{class:"token punctuation"},":"),t(" /tmp/test"),a("span",{class:"token punctuation"},"-"),t("reports\n\n    "),a("span",{class:"token key atrule"},"working_directory"),a("span",{class:"token punctuation"},":"),t(" ~/my"),a("span",{class:"token punctuation"},"-"),t("project\n\n    "),a("span",{class:"token key atrule"},"steps"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(" checkout\n\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"run"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"command"),a("span",{class:"token punctuation"},":"),t(" echo 127.0.0.1 devhost "),a("span",{class:"token punctuation"},"|"),t(" sudo tee "),a("span",{class:"token punctuation"},"-"),t("a /etc/hosts\n\n      "),a("span",{class:"token comment"},"# Create Postgres users and database"),t("\n      "),a("span",{class:"token comment"},"# Note the YAML heredoc '|' for nicer formatting"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"run"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token punctuation"},"|"),a("span",{class:"token scalar string"},"\n          sudo -u root createuser -h localhost --superuser ubuntu &&\n          sudo createdb -h localhost test_db"),t("\n\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"restore_cache"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"keys"),a("span",{class:"token punctuation"},":"),t("\n            "),a("span",{class:"token punctuation"},"-"),t(" v1"),a("span",{class:"token punctuation"},"-"),t("my"),a("span",{class:"token punctuation"},"-"),t("project"),a("span",{class:"token punctuation"},"-"),a("span",{class:"token punctuation"},"{"),a("span",{class:"token punctuation"},"{"),t(' checksum "project.clj" '),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},"}"),t("\n            "),a("span",{class:"token punctuation"},"-"),t(" v1"),a("span",{class:"token punctuation"},"-"),t("my"),a("span",{class:"token punctuation"},"-"),t("project"),a("span",{class:"token punctuation"},"-"),t("\n\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"run"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"environment"),a("span",{class:"token punctuation"},":"),t("\n            "),a("span",{class:"token key atrule"},"SSH_TARGET"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token string"},'"localhost"'),t("\n            "),a("span",{class:"token key atrule"},"TEST_ENV"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token string"},'"linux"'),t("\n          "),a("span",{class:"token key atrule"},"command"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token punctuation"},"|"),a("span",{class:"token scalar string"},"\n            set -xu\n            mkdir -p ${TEST_REPORTS}\n            run-tests.sh\n            cp out/tests/*.xml ${TEST_REPORTS}"),t("\n\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"run"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token punctuation"},"|"),a("span",{class:"token scalar string"},"\n          set -xu\n          mkdir -p /tmp/artifacts\n          create_jars.sh ${CIRCLE_BUILD_NUM}\n          cp *.jar /tmp/artifacts"),t("\n\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"save_cache"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"key"),a("span",{class:"token punctuation"},":"),t(" v1"),a("span",{class:"token punctuation"},"-"),t("my"),a("span",{class:"token punctuation"},"-"),t("project"),a("span",{class:"token punctuation"},"-"),a("span",{class:"token punctuation"},"{"),a("span",{class:"token punctuation"},"{"),t(' checksum "project.clj" '),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},"}"),t("\n          "),a("span",{class:"token key atrule"},"paths"),a("span",{class:"token punctuation"},":"),t("\n            "),a("span",{class:"token punctuation"},"-"),t(" ~/.m2\n\n      "),a("span",{class:"token comment"},"# Save artifacts"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"store_artifacts"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"path"),a("span",{class:"token punctuation"},":"),t(" /tmp/artifacts\n          "),a("span",{class:"token key atrule"},"destination"),a("span",{class:"token punctuation"},":"),t(" build\n\n      "),a("span",{class:"token comment"},"# Upload test results"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"store_test_results"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"path"),a("span",{class:"token punctuation"},":"),t(" /tmp/test"),a("span",{class:"token punctuation"},"-"),t("reports\n\n  "),a("span",{class:"token key atrule"},"deploy-stage"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token key atrule"},"docker"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"image"),a("span",{class:"token punctuation"},":"),t(" ubuntu"),a("span",{class:"token punctuation"},":"),a("span",{class:"token number"},"14.04"),t("\n    "),a("span",{class:"token key atrule"},"working_directory"),a("span",{class:"token punctuation"},":"),t(" /tmp/my"),a("span",{class:"token punctuation"},"-"),t("project\n    "),a("span",{class:"token key atrule"},"steps"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"run"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"name"),a("span",{class:"token punctuation"},":"),t(" Deploy if tests pass and branch is Staging\n          "),a("span",{class:"token key atrule"},"command"),a("span",{class:"token punctuation"},":"),t(" ansible"),a("span",{class:"token punctuation"},"-"),t("playbook site.yml "),a("span",{class:"token punctuation"},"-"),t("i staging\n\n  "),a("span",{class:"token key atrule"},"deploy-prod"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token key atrule"},"docker"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"image"),a("span",{class:"token punctuation"},":"),t(" ubuntu"),a("span",{class:"token punctuation"},":"),a("span",{class:"token number"},"14.04"),t("\n    "),a("span",{class:"token key atrule"},"working_directory"),a("span",{class:"token punctuation"},":"),t(" /tmp/my"),a("span",{class:"token punctuation"},"-"),t("project\n    "),a("span",{class:"token key atrule"},"steps"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"run"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"name"),a("span",{class:"token punctuation"},":"),t(" Deploy if tests pass and branch is Master\n          "),a("span",{class:"token key atrule"},"command"),a("span",{class:"token punctuation"},":"),t(" ansible"),a("span",{class:"token punctuation"},"-"),t("playbook site.yml "),a("span",{class:"token punctuation"},"-"),t("i production\n\n"),a("span",{class:"token key atrule"},"workflows"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token key atrule"},"version"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token number"},"2"),t("\n  "),a("span",{class:"token key atrule"},"build-deploy"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token key atrule"},"jobs"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"build"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"filters"),a("span",{class:"token punctuation"},":"),t("\n            "),a("span",{class:"token key atrule"},"branches"),a("span",{class:"token punctuation"},":"),t("\n              "),a("span",{class:"token key atrule"},"ignore"),a("span",{class:"token punctuation"},":"),t("\n                "),a("span",{class:"token punctuation"},"-"),t(" develop\n                "),a("span",{class:"token punctuation"},"-"),t(" /feature"),a("span",{class:"token punctuation"},"-"),t("."),a("span",{class:"token important"},"*/"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"deploy-stage"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"requires"),a("span",{class:"token punctuation"},":"),t("\n            "),a("span",{class:"token punctuation"},"-"),t(" build\n          "),a("span",{class:"token key atrule"},"filters"),a("span",{class:"token punctuation"},":"),t("\n            "),a("span",{class:"token key atrule"},"branches"),a("span",{class:"token punctuation"},":"),t("\n              "),a("span",{class:"token key atrule"},"only"),a("span",{class:"token punctuation"},":"),t(" staging\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"deploy-prod"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"requires"),a("span",{class:"token punctuation"},":"),t("\n            "),a("span",{class:"token punctuation"},"-"),t(" build\n          "),a("span",{class:"token key atrule"},"filters"),a("span",{class:"token punctuation"},":"),t("\n            "),a("span",{class:"token key atrule"},"branches"),a("span",{class:"token punctuation"},":"),t("\n              "),a("span",{class:"token key atrule"},"only"),a("span",{class:"token punctuation"},":"),t(" master\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991842-46397"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'version: 2\njobs:\n  build:\n    docker:\n      - image: ubuntu:14.04\n\n      - image: mongo:2.6.8\n        command: [mongod, --smallfiles]\n\n      - image: postgres:9.4.1\n        # some containers require setting environment variables\n        environment:\n          POSTGRES_USER: root\n\n      - image: redis@sha256:54057dd7e125ca41afe526a877e8bd35ec2cdd33b9217e022ed37bdcf7d09673\n\n      - image: rabbitmq:3.5.4\n\n    environment:\n      TEST_REPORTS: /tmp/test-reports\n\n    working_directory: ~/my-project\n\n    steps:\n      - checkout\n\n      - run:\n          command: echo 127.0.0.1 devhost | sudo tee -a /etc/hosts\n\n      # Create Postgres users and database\n      # Note the YAML heredoc \'|\' for nicer formatting\n      - run: |\n          sudo -u root createuser -h localhost --superuser ubuntu &&\n          sudo createdb -h localhost test_db\n\n      - restore_cache:\n          keys:\n            - v1-my-project-{{ checksum "project.clj" }}\n            - v1-my-project-\n\n      - run:\n          environment:\n            SSH_TARGET: "localhost"\n            TEST_ENV: "linux"\n          command: |\n            set -xu\n            mkdir -p ${TEST_REPORTS}\n            run-tests.sh\n            cp out/tests/*.xml ${TEST_REPORTS}\n\n      - run: |\n          set -xu\n          mkdir -p /tmp/artifacts\n          create_jars.sh ${CIRCLE_BUILD_NUM}\n          cp *.jar /tmp/artifacts\n\n      - save_cache:\n          key: v1-my-project-{{ checksum "project.clj" }}\n          paths:\n            - ~/.m2\n\n      # Save artifacts\n      - store_artifacts:\n          path: /tmp/artifacts\n          destination: build\n\n      # Upload test results\n      - store_test_results:\n          path: /tmp/test-reports\n\n  deploy-stage:\n    docker:\n      - image: ubuntu:14.04\n    working_directory: /tmp/my-project\n    steps:\n      - run:\n          name: Deploy if tests pass and branch is Staging\n          command: ansible-playbook site.yml -i staging\n\n  deploy-prod:\n    docker:\n      - image: ubuntu:14.04\n    working_directory: /tmp/my-project\n    steps:\n      - run:\n          name: Deploy if tests pass and branch is Master\n          command: ansible-playbook site.yml -i production\n\nworkflows:\n  version: 2\n  build-deploy:\n    jobs:\n      - build:\n          filters:\n            branches:\n              ignore:\n                - develop\n                - /feature-.*/\n      - deploy-stage:\n          requires:\n            - build\n          filters:\n            branches:\n              only: staging\n      - deploy-prod:\n          requires:\n            - build\n          filters:\n            branches:\n              only: master\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991842-46397","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br"),a("span",{class:"line-number"},"27"),a("br"),a("span",{class:"line-number"},"28"),a("br"),a("span",{class:"line-number"},"29"),a("br"),a("span",{class:"line-number"},"30"),a("br"),a("span",{class:"line-number"},"31"),a("br"),a("span",{class:"line-number"},"32"),a("br"),a("span",{class:"line-number"},"33"),a("br"),a("span",{class:"line-number"},"34"),a("br"),a("span",{class:"line-number"},"35"),a("br"),a("span",{class:"line-number"},"36"),a("br"),a("span",{class:"line-number"},"37"),a("br"),a("span",{class:"line-number"},"38"),a("br"),a("span",{class:"line-number"},"39"),a("br"),a("span",{class:"line-number"},"40"),a("br"),a("span",{class:"line-number"},"41"),a("br"),a("span",{class:"line-number"},"42"),a("br"),a("span",{class:"line-number"},"43"),a("br"),a("span",{class:"line-number"},"44"),a("br"),a("span",{class:"line-number"},"45"),a("br"),a("span",{class:"line-number"},"46"),a("br"),a("span",{class:"line-number"},"47"),a("br"),a("span",{class:"line-number"},"48"),a("br"),a("span",{class:"line-number"},"49"),a("br"),a("span",{class:"line-number"},"50"),a("br"),a("span",{class:"line-number"},"51"),a("br"),a("span",{class:"line-number"},"52"),a("br"),a("span",{class:"line-number"},"53"),a("br"),a("span",{class:"line-number"},"54"),a("br"),a("span",{class:"line-number"},"55"),a("br"),a("span",{class:"line-number"},"56"),a("br"),a("span",{class:"line-number"},"57"),a("br"),a("span",{class:"line-number"},"58"),a("br"),a("span",{class:"line-number"},"59"),a("br"),a("span",{class:"line-number"},"60"),a("br"),a("span",{class:"line-number"},"61"),a("br"),a("span",{class:"line-number"},"62"),a("br"),a("span",{class:"line-number"},"63"),a("br"),a("span",{class:"line-number"},"64"),a("br"),a("span",{class:"line-number"},"65"),a("br"),a("span",{class:"line-number"},"66"),a("br"),a("span",{class:"line-number"},"67"),a("br"),a("span",{class:"line-number"},"68"),a("br"),a("span",{class:"line-number"},"69"),a("br"),a("span",{class:"line-number"},"70"),a("br"),a("span",{class:"line-number"},"71"),a("br"),a("span",{class:"line-number"},"72"),a("br"),a("span",{class:"line-number"},"73"),a("br"),a("span",{class:"line-number"},"74"),a("br"),a("span",{class:"line-number"},"75"),a("br"),a("span",{class:"line-number"},"76"),a("br"),a("span",{class:"line-number"},"77"),a("br"),a("span",{class:"line-number"},"78"),a("br"),a("span",{class:"line-number"},"79"),a("br"),a("span",{class:"line-number"},"80"),a("br"),a("span",{class:"line-number"},"81"),a("br"),a("span",{class:"line-number"},"82"),a("br"),a("span",{class:"line-number"},"83"),a("br"),a("span",{class:"line-number"},"84"),a("br"),a("span",{class:"line-number"},"85"),a("br"),a("span",{class:"line-number"},"86"),a("br"),a("span",{class:"line-number"},"87"),a("br"),a("span",{class:"line-number"},"88"),a("br"),a("span",{class:"line-number"},"89"),a("br"),a("span",{class:"line-number"},"90"),a("br"),a("span",{class:"line-number"},"91"),a("br"),a("span",{class:"line-number"},"92"),a("br"),a("span",{class:"line-number"},"93"),a("br"),a("span",{class:"line-number"},"94"),a("br"),a("span",{class:"line-number"},"95"),a("br"),a("span",{class:"line-number"},"96"),a("br"),a("span",{class:"line-number"},"97"),a("br"),a("span",{class:"line-number"},"98"),a("br"),a("span",{class:"line-number"},"99"),a("br"),a("span",{class:"line-number"},"100"),a("br"),a("span",{class:"line-number"},"101"),a("br"),a("span",{class:"line-number"},"102"),a("br"),a("span",{class:"line-number"},"103"),a("br"),a("span",{class:"line-number"},"104"),a("br"),a("span",{class:"line-number"},"105"),a("br"),a("span",{class:"line-number"},"106"),a("br"),a("span",{class:"line-number"},"107"),a("br"),a("span",{class:"line-number"},"108"),a("br"),a("span",{class:"line-number"},"109"),a("br"),a("span",{class:"line-number"},"110"),a("br")])])]),a("li",null,[a("p",null,"设置/查看任务"),a("p",null,[a("img",{src:"https://gitee.com/artiely/Figure-bed/raw/master/images/20200310114344.png",alt:"image-20190613093327981"})])])],-1),E=a("h3",{id:"配置nodejs应用-1"},[a("a",{class:"header-anchor",href:"#配置nodejs应用-1","aria-hidden":"true"},"#"),t(" 配置Node.js应用")],-1),S=a("p",null,[a("code",null,".circleci/config.yml"),t("配置文件")],-1),I=a("div",{class:"language-yaml line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token key atrule"},"version"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token number"},"2"),t("\n"),a("span",{class:"token key atrule"},"jobs"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token key atrule"},"build"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token key atrule"},"docker"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"image"),a("span",{class:"token punctuation"},":"),t(" circleci/node"),a("span",{class:"token punctuation"},":"),a("span",{class:"token number"},"10"),t("\n    "),a("span",{class:"token key atrule"},"branches"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token key atrule"},"only"),a("span",{class:"token punctuation"},":"),t("\n        "),a("span",{class:"token punctuation"},"-"),t(" master\n    "),a("span",{class:"token key atrule"},"steps"),a("span",{class:"token punctuation"},":"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"add_ssh_keys"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"fingerprints"),a("span",{class:"token punctuation"},":"),t("\n            "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token string"},'"c5:20:8e:79:81:19:fd:c1:6c:c4:fb:41:58:92:9d:4f"'),t("\n      "),a("span",{class:"token punctuation"},"-"),t(" checkout\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"restore_cache"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"keys"),a("span",{class:"token punctuation"},":"),t("\n            "),a("span",{class:"token comment"},"# fallback to using the latest cache if no exact match is found"),t("\n            "),a("span",{class:"token punctuation"},"-"),t(" dependencies"),a("span",{class:"token punctuation"},"-"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"run"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"name"),a("span",{class:"token punctuation"},":"),t(" Install\n          "),a("span",{class:"token key atrule"},"command"),a("span",{class:"token punctuation"},":"),t(" yarn install\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"save_cache"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"paths"),a("span",{class:"token punctuation"},":"),t("\n            "),a("span",{class:"token punctuation"},"-"),t(" node_modules\n          "),a("span",{class:"token key atrule"},"key"),a("span",{class:"token punctuation"},":"),t(" dependencies"),a("span",{class:"token punctuation"},"-"),t("\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"run"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"name"),a("span",{class:"token punctuation"},":"),t(" build github pages\n          "),a("span",{class:"token key atrule"},"command"),a("span",{class:"token punctuation"},":"),t(" yarn build\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"run"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"name"),a("span",{class:"token punctuation"},":"),t(" Prepare shell commands\n          "),a("span",{class:"token key atrule"},"command"),a("span",{class:"token punctuation"},":"),t(" chmod +x scripts/deploy.sh\n      "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token key atrule"},"run"),a("span",{class:"token punctuation"},":"),t("\n          "),a("span",{class:"token key atrule"},"name"),a("span",{class:"token punctuation"},":"),t(" Run deploy scripts\n          "),a("span",{class:"token key atrule"},"command"),a("span",{class:"token punctuation"},":"),t(" ./scripts/deploy.sh\n\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991842-64631"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'version: 2\njobs:\n  build:\n    docker:\n      - image: circleci/node:10\n    branches:\n      only:\n        - master\n    steps:\n      - add_ssh_keys:\n          fingerprints:\n            - "c5:20:8e:79:81:19:fd:c1:6c:c4:fb:41:58:92:9d:4f"\n      - checkout\n      - restore_cache:\n          keys:\n            # fallback to using the latest cache if no exact match is found\n            - dependencies-\n      - run:\n          name: Install\n          command: yarn install\n      - save_cache:\n          paths:\n            - node_modules\n          key: dependencies-\n      - run:\n          name: build github pages\n          command: yarn build\n      - run:\n          name: Prepare shell commands\n          command: chmod +x scripts/deploy.sh\n      - run:\n          name: Run deploy scripts\n          command: ./scripts/deploy.sh\n\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991842-64631","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br"),a("span",{class:"line-number"},"27"),a("br"),a("span",{class:"line-number"},"28"),a("br"),a("span",{class:"line-number"},"29"),a("br"),a("span",{class:"line-number"},"30"),a("br"),a("span",{class:"line-number"},"31"),a("br"),a("span",{class:"line-number"},"32"),a("br"),a("span",{class:"line-number"},"33"),a("br"),a("span",{class:"line-number"},"34"),a("br")])],-1),w=a("p",null,"这里以发布到github page为示例：",-1),j=a("p",null,"deploy.sh文件的内容：",-1),O=a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token shebang important"},"#!/bin/sh"),t("\n"),a("span",{class:"token comment"},"# ideas used from https://gist.github.com/motemen/8595451"),t("\n\n"),a("span",{class:"token comment"},"# Based on https://github.com/eldarlabs/ghpages-deploy-script/blob/master/scripts/deploy-ghpages.sh"),t("\n"),a("span",{class:"token comment"},"# Used with their MIT license https://github.com/eldarlabs/ghpages-deploy-script/blob/master/LICENSE"),t("\n\n"),a("span",{class:"token comment"},"# abort the script if there is a non-zero error"),t("\n"),a("span",{class:"token builtin class-name"},"set"),t(" -e\n\n"),a("span",{class:"token comment"},"# show where we are on the machine"),t("\n"),a("span",{class:"token builtin class-name"},"pwd"),t("\n"),a("span",{class:"token assign-left variable"},"remote"),a("span",{class:"token operator"},"="),a("span",{class:"token variable"},[a("span",{class:"token variable"},"$("),a("span",{class:"token function"},"git"),t(" config remote.origin.url"),a("span",{class:"token variable"},")")]),t("\n\n"),a("span",{class:"token builtin class-name"},"echo"),t(),a("span",{class:"token string"},"'remote is: '"),a("span",{class:"token variable"},"$remote"),t("\n\n"),a("span",{class:"token comment"},"# make a directory to put the gp-pages branch"),t("\n"),a("span",{class:"token function"},"mkdir"),t(" gh-pages-branch\n"),a("span",{class:"token builtin class-name"},"cd"),t(" gh-pages-branch\n"),a("span",{class:"token comment"},"# now lets setup a new repo so we can update the gh-pages branch"),t("\n"),a("span",{class:"token function"},"git"),t(" config --global user.email "),a("span",{class:"token string"},[t('"'),a("span",{class:"token variable"},"$GH_EMAIL"),t('"')]),t(),a("span",{class:"token operator"},">"),t(" /dev/null "),a("span",{class:"token operator"},[a("span",{class:"token file-descriptor important"},"2"),t(">")]),a("span",{class:"token file-descriptor important"},"&1"),t("\n"),a("span",{class:"token function"},"git"),t(" config --global user.name "),a("span",{class:"token string"},[t('"'),a("span",{class:"token variable"},"$GH_NAME"),t('"')]),t(),a("span",{class:"token operator"},">"),t(" /dev/null "),a("span",{class:"token operator"},[a("span",{class:"token file-descriptor important"},"2"),t(">")]),a("span",{class:"token file-descriptor important"},"&1"),t("\n"),a("span",{class:"token function"},"git"),t(" init\n"),a("span",{class:"token function"},"git"),t(" remote "),a("span",{class:"token function"},"add"),t(" --fetch origin "),a("span",{class:"token string"},[t('"'),a("span",{class:"token variable"},"$remote"),t('"')]),t("\n\n"),a("span",{class:"token builtin class-name"},"echo"),t(),a("span",{class:"token string"},"'email is: '"),a("span",{class:"token variable"},"$GH_EMAIL"),t("\n"),a("span",{class:"token builtin class-name"},"echo"),t(),a("span",{class:"token string"},"'name is: '"),a("span",{class:"token variable"},"$GH_NAME"),t("\n"),a("span",{class:"token builtin class-name"},"echo"),t(),a("span",{class:"token string"},"'sitesource is: '"),a("span",{class:"token variable"},"$siteSource"),t("\n\n"),a("span",{class:"token comment"},"# switch into the the gh-pages branch"),t("\n"),a("span",{class:"token keyword"},"if"),t(),a("span",{class:"token function"},"git"),t(" rev-parse --verify origin/gh-pages "),a("span",{class:"token operator"},">"),t(" /dev/null "),a("span",{class:"token operator"},[a("span",{class:"token file-descriptor important"},"2"),t(">")]),a("span",{class:"token file-descriptor important"},"&1"),t("\n"),a("span",{class:"token keyword"},"then"),t("\n    "),a("span",{class:"token function"},"git"),t(" checkout gh-pages\n    "),a("span",{class:"token comment"},"# delete any old site as we are going to replace it"),t("\n    "),a("span",{class:"token comment"},"# Note: this explodes if there aren't any, so moving it here for now"),t("\n    "),a("span",{class:"token function"},"git"),t(),a("span",{class:"token function"},"rm"),t(" -rf "),a("span",{class:"token builtin class-name"},"."),t("\n"),a("span",{class:"token keyword"},"else"),t("\n    "),a("span",{class:"token function"},"git"),t(" checkout --orphan gh-pages\n"),a("span",{class:"token keyword"},"fi"),t("\n\n"),a("span",{class:"token comment"},"# copy over or recompile the new site"),t("\n"),a("span",{class:"token function"},"cp"),t(" -a "),a("span",{class:"token string"},[t('"../'),a("span",{class:"token variable"},"${siteSource}"),t('/."')]),t(),a("span",{class:"token builtin class-name"},"."),t("\n\n"),a("span",{class:"token function"},"ls"),t(" -la\n\n"),a("span",{class:"token comment"},"# stage any changes and new files"),t("\n"),a("span",{class:"token function"},"git"),t(),a("span",{class:"token function"},"add"),t(" -A\n"),a("span",{class:"token comment"},"# now commit, ignoring branch gh-pages doesn't seem to work, so trying skip"),t("\n"),a("span",{class:"token function"},"git"),t(" commit --allow-empty -m "),a("span",{class:"token string"},'"Deploy to GitHub pages [ci skip]"'),t("\n"),a("span",{class:"token comment"},"# and push, but send any output to /dev/null to hide anything sensitive"),t("\n"),a("span",{class:"token function"},"git"),t(" push --force --quiet origin gh-pages\n"),a("span",{class:"token comment"},"# go back to where we started and remove the gh-pages git repo we made and used"),t("\n"),a("span",{class:"token comment"},"# for deployment"),t("\n"),a("span",{class:"token builtin class-name"},"cd"),t(),a("span",{class:"token punctuation"},".."),t("\n"),a("span",{class:"token function"},"rm"),t(" -rf gh-pages-branch\n\n"),a("span",{class:"token builtin class-name"},"echo"),t(),a("span",{class:"token string"},'"Finished Deployment!"'),t("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991843-49451"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'#!/bin/sh\n# ideas used from https://gist.github.com/motemen/8595451\n\n# Based on https://github.com/eldarlabs/ghpages-deploy-script/blob/master/scripts/deploy-ghpages.sh\n# Used with their MIT license https://github.com/eldarlabs/ghpages-deploy-script/blob/master/LICENSE\n\n# abort the script if there is a non-zero error\nset -e\n\n# show where we are on the machine\npwd\nremote=$(git config remote.origin.url)\n\necho \'remote is: \'$remote\n\n# make a directory to put the gp-pages branch\nmkdir gh-pages-branch\ncd gh-pages-branch\n# now lets setup a new repo so we can update the gh-pages branch\ngit config --global user.email "$GH_EMAIL" > /dev/null 2>&1\ngit config --global user.name "$GH_NAME" > /dev/null 2>&1\ngit init\ngit remote add --fetch origin "$remote"\n\necho \'email is: \'$GH_EMAIL\necho \'name is: \'$GH_NAME\necho \'sitesource is: \'$siteSource\n\n# switch into the the gh-pages branch\nif git rev-parse --verify origin/gh-pages > /dev/null 2>&1\nthen\n    git checkout gh-pages\n    # delete any old site as we are going to replace it\n    # Note: this explodes if there aren\'t any, so moving it here for now\n    git rm -rf .\nelse\n    git checkout --orphan gh-pages\nfi\n\n# copy over or recompile the new site\ncp -a "../${siteSource}/." .\n\nls -la\n\n# stage any changes and new files\ngit add -A\n# now commit, ignoring branch gh-pages doesn\'t seem to work, so trying skip\ngit commit --allow-empty -m "Deploy to GitHub pages [ci skip]"\n# and push, but send any output to /dev/null to hide anything sensitive\ngit push --force --quiet origin gh-pages\n# go back to where we started and remove the gh-pages git repo we made and used\n# for deployment\ncd ..\nrm -rf gh-pages-branch\n\necho "Finished Deployment!"\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991843-49451","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br"),a("span",{class:"line-number"},"27"),a("br"),a("span",{class:"line-number"},"28"),a("br"),a("span",{class:"line-number"},"29"),a("br"),a("span",{class:"line-number"},"30"),a("br"),a("span",{class:"line-number"},"31"),a("br"),a("span",{class:"line-number"},"32"),a("br"),a("span",{class:"line-number"},"33"),a("br"),a("span",{class:"line-number"},"34"),a("br"),a("span",{class:"line-number"},"35"),a("br"),a("span",{class:"line-number"},"36"),a("br"),a("span",{class:"line-number"},"37"),a("br"),a("span",{class:"line-number"},"38"),a("br"),a("span",{class:"line-number"},"39"),a("br"),a("span",{class:"line-number"},"40"),a("br"),a("span",{class:"line-number"},"41"),a("br"),a("span",{class:"line-number"},"42"),a("br"),a("span",{class:"line-number"},"43"),a("br"),a("span",{class:"line-number"},"44"),a("br"),a("span",{class:"line-number"},"45"),a("br"),a("span",{class:"line-number"},"46"),a("br"),a("span",{class:"line-number"},"47"),a("br"),a("span",{class:"line-number"},"48"),a("br"),a("span",{class:"line-number"},"49"),a("br"),a("span",{class:"line-number"},"50"),a("br"),a("span",{class:"line-number"},"51"),a("br"),a("span",{class:"line-number"},"52"),a("br"),a("span",{class:"line-number"},"53"),a("br"),a("span",{class:"line-number"},"54"),a("br"),a("span",{class:"line-number"},"55"),a("br"),a("span",{class:"line-number"},"56"),a("br")])],-1),P=s('',34),R=a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[t("version: "),a("span",{class:"token string"},"'3'"),t("\nservices:\n  jenkins:\n    container_name: "),a("span",{class:"token string"},"'jenkins'"),t("\n    image: jenkins/jenkins\n    restart: always\n    user: jenkins:"),a("span",{class:"token operator"},"<"),t("这里填Docker用户组的ID，见下面"),a("span",{class:"token operator"},">"),t("\n    ports:\n    - "),a("span",{class:"token string"},'"8080:8080"'),t("\n    - "),a("span",{class:"token string"},'"50000:50000"'),t("\n    volumes:\n    - /home/jenkins/data:/var/jenkins_home\n    - /usr/bin/docker:/usr/bin/docker\n    - /var/run/docker.sock:/var/run/docker.sock\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991843-31946"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"version: '3'\nservices:\n  jenkins:\n    container_name: 'jenkins'\n    image: jenkins/jenkins\n    restart: always\n    user: jenkins:<这里填Docker用户组的ID，见下面>\n    ports:\n    - \"8080:8080\"\n    - \"50000:50000\"\n    volumes:\n    - /home/jenkins/data:/var/jenkins_home\n    - /usr/bin/docker:/usr/bin/docker\n    - /var/run/docker.sock:/var/run/docker.sock\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991843-31946","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br")])],-1),U=a("p",null,"上面的脚本使用注意：",-1),x=a("ol",null,[a("li",null,[a("p",null,"创建本地jenkins数据目录"),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token function"},"mkdir"),t(" -p /home/jenkins\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991843-84712"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"mkdir -p /home/jenkins\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991843-84712","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br")])])]),a("li",null,[a("p",null,"查看docker用户组的ID"),a("div",{class:"language-bash line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token function"},"cat"),t(" /etc/group "),a("span",{class:"token operator"},"|"),a("span",{class:"token function"},"grep"),t(" docker\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991843-30359"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"cat /etc/group |grep docker\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991843-30359","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br")])])]),a("li",null,[a("p",null,[t("执行"),a("code",null,"docker-compose up -d")])])],-1),D=a("h3",{id:"gitlab的docker启动配置文件"},[a("a",{class:"header-anchor",href:"#gitlab的docker启动配置文件","aria-hidden":"true"},"#"),t(" gitlab的docker启动配置文件")],-1),L=a("p",null,[t("项目地址："),a("a",{href:"https://github.com/sameersbn/docker-gitlab",target:"_blank",rel:"noopener noreferrer"},"https://github.com/sameersbn/docker-gitlab")],-1),N=a("div",{class:"language-yaml line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token key atrule"},"version"),a("span",{class:"token punctuation"},":"),t(),a("span",{class:"token string"},"'2'"),t("\n\n"),a("span",{class:"token key atrule"},"services"),a("span",{class:"token punctuation"},":"),t("\n  "),a("span",{class:"token key atrule"},"redis"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token key atrule"},"restart"),a("span",{class:"token punctuation"},":"),t(" always\n    "),a("span",{class:"token key atrule"},"image"),a("span",{class:"token punctuation"},":"),t(" sameersbn/redis"),a("span",{class:"token punctuation"},":"),t("4.0.9"),a("span",{class:"token punctuation"},"-"),a("span",{class:"token number"},"1"),t("\n    "),a("span",{class:"token key atrule"},"command"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token punctuation"},"-"),a("span",{class:"token punctuation"},"-"),t("loglevel warning\n    "),a("span",{class:"token key atrule"},"volumes"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token punctuation"},"-"),t(" /srv/docker/gitlab/redis"),a("span",{class:"token punctuation"},":"),t("/var/lib/redis"),a("span",{class:"token punctuation"},":"),t("Z\n\n  "),a("span",{class:"token key atrule"},"postgresql"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token key atrule"},"restart"),a("span",{class:"token punctuation"},":"),t(" always\n    "),a("span",{class:"token key atrule"},"image"),a("span",{class:"token punctuation"},":"),t(" sameersbn/postgresql"),a("span",{class:"token punctuation"},":"),a("span",{class:"token number"},"10"),t("\n    "),a("span",{class:"token key atrule"},"volumes"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token punctuation"},"-"),t(" /srv/docker/gitlab/postgresql"),a("span",{class:"token punctuation"},":"),t("/var/lib/postgresql"),a("span",{class:"token punctuation"},":"),t("Z\n    "),a("span",{class:"token key atrule"},"environment"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token punctuation"},"-"),t(" DB_USER=gitlab\n    "),a("span",{class:"token punctuation"},"-"),t(" DB_PASS=password\n    "),a("span",{class:"token punctuation"},"-"),t(" DB_NAME=gitlabhq_production\n    "),a("span",{class:"token punctuation"},"-"),t(" DB_EXTENSION=pg_trgm\n\n  "),a("span",{class:"token key atrule"},"gitlab"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token key atrule"},"restart"),a("span",{class:"token punctuation"},":"),t(" always\n    "),a("span",{class:"token key atrule"},"image"),a("span",{class:"token punctuation"},":"),t(" sameersbn/gitlab"),a("span",{class:"token punctuation"},":"),t("11.11.2\n    "),a("span",{class:"token key atrule"},"depends_on"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token punctuation"},"-"),t(" redis\n    "),a("span",{class:"token punctuation"},"-"),t(" postgresql\n    "),a("span",{class:"token key atrule"},"ports"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token string"},'"10080:80"'),t("\n    "),a("span",{class:"token punctuation"},"-"),t(),a("span",{class:"token string"},'"10022:22"'),t("\n    "),a("span",{class:"token key atrule"},"volumes"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token punctuation"},"-"),t(" /srv/docker/gitlab/gitlab"),a("span",{class:"token punctuation"},":"),t("/home/git/data"),a("span",{class:"token punctuation"},":"),t("Z\n    "),a("span",{class:"token key atrule"},"environment"),a("span",{class:"token punctuation"},":"),t("\n    "),a("span",{class:"token punctuation"},"-"),t(" DEBUG=false\n\n    "),a("span",{class:"token punctuation"},"-"),t(" DB_ADAPTER=postgresql\n    "),a("span",{class:"token punctuation"},"-"),t(" DB_HOST=postgresql\n    "),a("span",{class:"token punctuation"},"-"),t(" DB_PORT=5432\n    "),a("span",{class:"token punctuation"},"-"),t(" DB_USER=gitlab\n    "),a("span",{class:"token punctuation"},"-"),t(" DB_PASS=password\n    "),a("span",{class:"token punctuation"},"-"),t(" DB_NAME=gitlabhq_production\n\n    "),a("span",{class:"token punctuation"},"-"),t(" REDIS_HOST=redis\n    "),a("span",{class:"token punctuation"},"-"),t(" REDIS_PORT=6379\n\n    "),a("span",{class:"token punctuation"},"-"),t(" TZ=Asia/Kolkata\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_TIMEZONE=Kolkata\n\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_HTTPS=false\n    "),a("span",{class:"token punctuation"},"-"),t(" SSL_SELF_SIGNED=false\n\n    "),a("span",{class:"token comment"},"# 这里修改成服务器的IP或者域名"),t("\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_HOST=localhost\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_PORT=10080\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_SSH_PORT=10022\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_RELATIVE_URL_ROOT=\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_SECRETS_DB_KEY_BASE=long"),a("span",{class:"token punctuation"},"-"),t("and"),a("span",{class:"token punctuation"},"-"),t("random"),a("span",{class:"token punctuation"},"-"),t("alphanumeric"),a("span",{class:"token punctuation"},"-"),t("string\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_SECRETS_SECRET_KEY_BASE=long"),a("span",{class:"token punctuation"},"-"),t("and"),a("span",{class:"token punctuation"},"-"),t("random"),a("span",{class:"token punctuation"},"-"),t("alphanumeric"),a("span",{class:"token punctuation"},"-"),t("string\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_SECRETS_OTP_KEY_BASE=long"),a("span",{class:"token punctuation"},"-"),t("and"),a("span",{class:"token punctuation"},"-"),t("random"),a("span",{class:"token punctuation"},"-"),t("alphanumeric"),a("span",{class:"token punctuation"},"-"),t("string\n\n\t\t"),a("span",{class:"token comment"},"# 这里给一个长度大于8的密码"),t("\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_ROOT_PASSWORD=12345678\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_ROOT_EMAIL=demo@demo.cn\n\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_NOTIFY_ON_BROKEN_BUILDS=true\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_NOTIFY_PUSHER=false\n\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_EMAIL=notifications@example.com\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_EMAIL_REPLY_TO=noreply@example.com\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_INCOMING_EMAIL_ADDRESS=reply@example.com\n\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_BACKUP_SCHEDULE=daily\n    "),a("span",{class:"token punctuation"},"-"),t(" GITLAB_BACKUP_TIME=01"),a("span",{class:"token punctuation"},":"),a("span",{class:"token number"},"00"),t("\n\n    "),a("span",{class:"token punctuation"},"-"),t(" SMTP_ENABLED=false\n    "),a("span",{class:"token punctuation"},"-"),t(" SMTP_DOMAIN=www.example.com\n    "),a("span",{class:"token punctuation"},"-"),t(" SMTP_HOST=smtp.gmail.com\n    "),a("span",{class:"token punctuation"},"-"),t(" SMTP_PORT=587\n    "),a("span",{class:"token punctuation"},"-"),t(" SMTP_USER=mailer@example.com\n    "),a("span",{class:"token punctuation"},"-"),t(" SMTP_PASS=password\n    "),a("span",{class:"token punctuation"},"-"),t(" SMTP_STARTTLS=true\n    "),a("span",{class:"token punctuation"},"-"),t(" SMTP_AUTHENTICATION=login\n\n    "),a("span",{class:"token punctuation"},"-"),t(" IMAP_ENABLED=false\n    "),a("span",{class:"token punctuation"},"-"),t(" IMAP_HOST=imap.gmail.com\n    "),a("span",{class:"token punctuation"},"-"),t(" IMAP_PORT=993\n    "),a("span",{class:"token punctuation"},"-"),t(" IMAP_USER=mailer@example.com\n    "),a("span",{class:"token punctuation"},"-"),t(" IMAP_PASS=password\n    "),a("span",{class:"token punctuation"},"-"),t(" IMAP_SSL=true\n    "),a("span",{class:"token punctuation"},"-"),t(" IMAP_STARTTLS=false\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_ENABLED=false\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_AUTO_SIGN_IN_WITH_PROVIDER=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_ALLOW_SSO=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_BLOCK_AUTO_CREATED_USERS=true\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_AUTO_LINK_LDAP_USER=false\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_AUTO_LINK_SAML_USER=false\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_EXTERNAL_PROVIDERS=\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_CAS3_LABEL=cas3\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_CAS3_SERVER=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_CAS3_DISABLE_SSL_VERIFICATION=false\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_CAS3_LOGIN_URL=/cas/login\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_CAS3_VALIDATE_URL=/cas/p3/serviceValidate\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_CAS3_LOGOUT_URL=/cas/logout\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_GOOGLE_API_KEY=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_GOOGLE_APP_SECRET=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_GOOGLE_RESTRICT_DOMAIN=\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_FACEBOOK_API_KEY=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_FACEBOOK_APP_SECRET=\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_TWITTER_API_KEY=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_TWITTER_APP_SECRET=\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_GITHUB_API_KEY=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_GITHUB_APP_SECRET=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_GITHUB_URL=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_GITHUB_VERIFY_SSL=\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_GITLAB_API_KEY=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_GITLAB_APP_SECRET=\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_BITBUCKET_API_KEY=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_BITBUCKET_APP_SECRET=\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_ASSERTION_CONSUMER_SERVICE_URL=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_IDP_CERT_FINGERPRINT=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_IDP_SSO_TARGET_URL=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_ISSUER=\n    "),a("span",{class:"token punctuation"},"-"),t(' OAUTH_SAML_LABEL="Our SAML Provider"\n    '),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_NAME_IDENTIFIER_FORMAT=urn"),a("span",{class:"token punctuation"},":"),t("oasis"),a("span",{class:"token punctuation"},":"),t("names"),a("span",{class:"token punctuation"},":"),t("tc"),a("span",{class:"token punctuation"},":"),t("SAML"),a("span",{class:"token punctuation"},":"),t("2.0"),a("span",{class:"token punctuation"},":"),t("nameid"),a("span",{class:"token punctuation"},"-"),t("format"),a("span",{class:"token punctuation"},":"),t("transient\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_GROUPS_ATTRIBUTE=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_EXTERNAL_GROUPS=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_ATTRIBUTE_STATEMENTS_EMAIL=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_ATTRIBUTE_STATEMENTS_NAME=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_ATTRIBUTE_STATEMENTS_USERNAME=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_ATTRIBUTE_STATEMENTS_FIRST_NAME=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_SAML_ATTRIBUTE_STATEMENTS_LAST_NAME=\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_CROWD_SERVER_URL=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_CROWD_APP_NAME=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_CROWD_APP_PASSWORD=\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_AUTH0_CLIENT_ID=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_AUTH0_CLIENT_SECRET=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_AUTH0_DOMAIN=\n\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_AZURE_API_KEY=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_AZURE_API_SECRET=\n    "),a("span",{class:"token punctuation"},"-"),t(" OAUTH_AZURE_TENANT_ID=\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629556991843-4145"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'version: \'2\'\n\nservices:\n  redis:\n    restart: always\n    image: sameersbn/redis:4.0.9-1\n    command:\n    - --loglevel warning\n    volumes:\n    - /srv/docker/gitlab/redis:/var/lib/redis:Z\n\n  postgresql:\n    restart: always\n    image: sameersbn/postgresql:10\n    volumes:\n    - /srv/docker/gitlab/postgresql:/var/lib/postgresql:Z\n    environment:\n    - DB_USER=gitlab\n    - DB_PASS=password\n    - DB_NAME=gitlabhq_production\n    - DB_EXTENSION=pg_trgm\n\n  gitlab:\n    restart: always\n    image: sameersbn/gitlab:11.11.2\n    depends_on:\n    - redis\n    - postgresql\n    ports:\n    - "10080:80"\n    - "10022:22"\n    volumes:\n    - /srv/docker/gitlab/gitlab:/home/git/data:Z\n    environment:\n    - DEBUG=false\n\n    - DB_ADAPTER=postgresql\n    - DB_HOST=postgresql\n    - DB_PORT=5432\n    - DB_USER=gitlab\n    - DB_PASS=password\n    - DB_NAME=gitlabhq_production\n\n    - REDIS_HOST=redis\n    - REDIS_PORT=6379\n\n    - TZ=Asia/Kolkata\n    - GITLAB_TIMEZONE=Kolkata\n\n    - GITLAB_HTTPS=false\n    - SSL_SELF_SIGNED=false\n\n    # 这里修改成服务器的IP或者域名\n    - GITLAB_HOST=localhost\n    - GITLAB_PORT=10080\n    - GITLAB_SSH_PORT=10022\n    - GITLAB_RELATIVE_URL_ROOT=\n    - GITLAB_SECRETS_DB_KEY_BASE=long-and-random-alphanumeric-string\n    - GITLAB_SECRETS_SECRET_KEY_BASE=long-and-random-alphanumeric-string\n    - GITLAB_SECRETS_OTP_KEY_BASE=long-and-random-alphanumeric-string\n\n\t\t# 这里给一个长度大于8的密码\n    - GITLAB_ROOT_PASSWORD=12345678\n    - GITLAB_ROOT_EMAIL=demo@demo.cn\n\n    - GITLAB_NOTIFY_ON_BROKEN_BUILDS=true\n    - GITLAB_NOTIFY_PUSHER=false\n\n    - GITLAB_EMAIL=notifications@example.com\n    - GITLAB_EMAIL_REPLY_TO=noreply@example.com\n    - GITLAB_INCOMING_EMAIL_ADDRESS=reply@example.com\n\n    - GITLAB_BACKUP_SCHEDULE=daily\n    - GITLAB_BACKUP_TIME=01:00\n\n    - SMTP_ENABLED=false\n    - SMTP_DOMAIN=www.example.com\n    - SMTP_HOST=smtp.gmail.com\n    - SMTP_PORT=587\n    - SMTP_USER=mailer@example.com\n    - SMTP_PASS=password\n    - SMTP_STARTTLS=true\n    - SMTP_AUTHENTICATION=login\n\n    - IMAP_ENABLED=false\n    - IMAP_HOST=imap.gmail.com\n    - IMAP_PORT=993\n    - IMAP_USER=mailer@example.com\n    - IMAP_PASS=password\n    - IMAP_SSL=true\n    - IMAP_STARTTLS=false\n\n    - OAUTH_ENABLED=false\n    - OAUTH_AUTO_SIGN_IN_WITH_PROVIDER=\n    - OAUTH_ALLOW_SSO=\n    - OAUTH_BLOCK_AUTO_CREATED_USERS=true\n    - OAUTH_AUTO_LINK_LDAP_USER=false\n    - OAUTH_AUTO_LINK_SAML_USER=false\n    - OAUTH_EXTERNAL_PROVIDERS=\n\n    - OAUTH_CAS3_LABEL=cas3\n    - OAUTH_CAS3_SERVER=\n    - OAUTH_CAS3_DISABLE_SSL_VERIFICATION=false\n    - OAUTH_CAS3_LOGIN_URL=/cas/login\n    - OAUTH_CAS3_VALIDATE_URL=/cas/p3/serviceValidate\n    - OAUTH_CAS3_LOGOUT_URL=/cas/logout\n\n    - OAUTH_GOOGLE_API_KEY=\n    - OAUTH_GOOGLE_APP_SECRET=\n    - OAUTH_GOOGLE_RESTRICT_DOMAIN=\n\n    - OAUTH_FACEBOOK_API_KEY=\n    - OAUTH_FACEBOOK_APP_SECRET=\n\n    - OAUTH_TWITTER_API_KEY=\n    - OAUTH_TWITTER_APP_SECRET=\n\n    - OAUTH_GITHUB_API_KEY=\n    - OAUTH_GITHUB_APP_SECRET=\n    - OAUTH_GITHUB_URL=\n    - OAUTH_GITHUB_VERIFY_SSL=\n\n    - OAUTH_GITLAB_API_KEY=\n    - OAUTH_GITLAB_APP_SECRET=\n\n    - OAUTH_BITBUCKET_API_KEY=\n    - OAUTH_BITBUCKET_APP_SECRET=\n\n    - OAUTH_SAML_ASSERTION_CONSUMER_SERVICE_URL=\n    - OAUTH_SAML_IDP_CERT_FINGERPRINT=\n    - OAUTH_SAML_IDP_SSO_TARGET_URL=\n    - OAUTH_SAML_ISSUER=\n    - OAUTH_SAML_LABEL="Our SAML Provider"\n    - OAUTH_SAML_NAME_IDENTIFIER_FORMAT=urn:oasis:names:tc:SAML:2.0:nameid-format:transient\n    - OAUTH_SAML_GROUPS_ATTRIBUTE=\n    - OAUTH_SAML_EXTERNAL_GROUPS=\n    - OAUTH_SAML_ATTRIBUTE_STATEMENTS_EMAIL=\n    - OAUTH_SAML_ATTRIBUTE_STATEMENTS_NAME=\n    - OAUTH_SAML_ATTRIBUTE_STATEMENTS_USERNAME=\n    - OAUTH_SAML_ATTRIBUTE_STATEMENTS_FIRST_NAME=\n    - OAUTH_SAML_ATTRIBUTE_STATEMENTS_LAST_NAME=\n\n    - OAUTH_CROWD_SERVER_URL=\n    - OAUTH_CROWD_APP_NAME=\n    - OAUTH_CROWD_APP_PASSWORD=\n\n    - OAUTH_AUTH0_CLIENT_ID=\n    - OAUTH_AUTH0_CLIENT_SECRET=\n    - OAUTH_AUTH0_DOMAIN=\n\n    - OAUTH_AZURE_API_KEY=\n    - OAUTH_AZURE_API_SECRET=\n    - OAUTH_AZURE_TENANT_ID=\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629556991843-4145","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br"),a("span",{class:"line-number"},"27"),a("br"),a("span",{class:"line-number"},"28"),a("br"),a("span",{class:"line-number"},"29"),a("br"),a("span",{class:"line-number"},"30"),a("br"),a("span",{class:"line-number"},"31"),a("br"),a("span",{class:"line-number"},"32"),a("br"),a("span",{class:"line-number"},"33"),a("br"),a("span",{class:"line-number"},"34"),a("br"),a("span",{class:"line-number"},"35"),a("br"),a("span",{class:"line-number"},"36"),a("br"),a("span",{class:"line-number"},"37"),a("br"),a("span",{class:"line-number"},"38"),a("br"),a("span",{class:"line-number"},"39"),a("br"),a("span",{class:"line-number"},"40"),a("br"),a("span",{class:"line-number"},"41"),a("br"),a("span",{class:"line-number"},"42"),a("br"),a("span",{class:"line-number"},"43"),a("br"),a("span",{class:"line-number"},"44"),a("br"),a("span",{class:"line-number"},"45"),a("br"),a("span",{class:"line-number"},"46"),a("br"),a("span",{class:"line-number"},"47"),a("br"),a("span",{class:"line-number"},"48"),a("br"),a("span",{class:"line-number"},"49"),a("br"),a("span",{class:"line-number"},"50"),a("br"),a("span",{class:"line-number"},"51"),a("br"),a("span",{class:"line-number"},"52"),a("br"),a("span",{class:"line-number"},"53"),a("br"),a("span",{class:"line-number"},"54"),a("br"),a("span",{class:"line-number"},"55"),a("br"),a("span",{class:"line-number"},"56"),a("br"),a("span",{class:"line-number"},"57"),a("br"),a("span",{class:"line-number"},"58"),a("br"),a("span",{class:"line-number"},"59"),a("br"),a("span",{class:"line-number"},"60"),a("br"),a("span",{class:"line-number"},"61"),a("br"),a("span",{class:"line-number"},"62"),a("br"),a("span",{class:"line-number"},"63"),a("br"),a("span",{class:"line-number"},"64"),a("br"),a("span",{class:"line-number"},"65"),a("br"),a("span",{class:"line-number"},"66"),a("br"),a("span",{class:"line-number"},"67"),a("br"),a("span",{class:"line-number"},"68"),a("br"),a("span",{class:"line-number"},"69"),a("br"),a("span",{class:"line-number"},"70"),a("br"),a("span",{class:"line-number"},"71"),a("br"),a("span",{class:"line-number"},"72"),a("br"),a("span",{class:"line-number"},"73"),a("br"),a("span",{class:"line-number"},"74"),a("br"),a("span",{class:"line-number"},"75"),a("br"),a("span",{class:"line-number"},"76"),a("br"),a("span",{class:"line-number"},"77"),a("br"),a("span",{class:"line-number"},"78"),a("br"),a("span",{class:"line-number"},"79"),a("br"),a("span",{class:"line-number"},"80"),a("br"),a("span",{class:"line-number"},"81"),a("br"),a("span",{class:"line-number"},"82"),a("br"),a("span",{class:"line-number"},"83"),a("br"),a("span",{class:"line-number"},"84"),a("br"),a("span",{class:"line-number"},"85"),a("br"),a("span",{class:"line-number"},"86"),a("br"),a("span",{class:"line-number"},"87"),a("br"),a("span",{class:"line-number"},"88"),a("br"),a("span",{class:"line-number"},"89"),a("br"),a("span",{class:"line-number"},"90"),a("br"),a("span",{class:"line-number"},"91"),a("br"),a("span",{class:"line-number"},"92"),a("br"),a("span",{class:"line-number"},"93"),a("br"),a("span",{class:"line-number"},"94"),a("br"),a("span",{class:"line-number"},"95"),a("br"),a("span",{class:"line-number"},"96"),a("br"),a("span",{class:"line-number"},"97"),a("br"),a("span",{class:"line-number"},"98"),a("br"),a("span",{class:"line-number"},"99"),a("br"),a("span",{class:"line-number"},"100"),a("br"),a("span",{class:"line-number"},"101"),a("br"),a("span",{class:"line-number"},"102"),a("br"),a("span",{class:"line-number"},"103"),a("br"),a("span",{class:"line-number"},"104"),a("br"),a("span",{class:"line-number"},"105"),a("br"),a("span",{class:"line-number"},"106"),a("br"),a("span",{class:"line-number"},"107"),a("br"),a("span",{class:"line-number"},"108"),a("br"),a("span",{class:"line-number"},"109"),a("br"),a("span",{class:"line-number"},"110"),a("br"),a("span",{class:"line-number"},"111"),a("br"),a("span",{class:"line-number"},"112"),a("br"),a("span",{class:"line-number"},"113"),a("br"),a("span",{class:"line-number"},"114"),a("br"),a("span",{class:"line-number"},"115"),a("br"),a("span",{class:"line-number"},"116"),a("br"),a("span",{class:"line-number"},"117"),a("br"),a("span",{class:"line-number"},"118"),a("br"),a("span",{class:"line-number"},"119"),a("br"),a("span",{class:"line-number"},"120"),a("br"),a("span",{class:"line-number"},"121"),a("br"),a("span",{class:"line-number"},"122"),a("br"),a("span",{class:"line-number"},"123"),a("br"),a("span",{class:"line-number"},"124"),a("br"),a("span",{class:"line-number"},"125"),a("br"),a("span",{class:"line-number"},"126"),a("br"),a("span",{class:"line-number"},"127"),a("br"),a("span",{class:"line-number"},"128"),a("br"),a("span",{class:"line-number"},"129"),a("br"),a("span",{class:"line-number"},"130"),a("br"),a("span",{class:"line-number"},"131"),a("br"),a("span",{class:"line-number"},"132"),a("br"),a("span",{class:"line-number"},"133"),a("br"),a("span",{class:"line-number"},"134"),a("br"),a("span",{class:"line-number"},"135"),a("br"),a("span",{class:"line-number"},"136"),a("br"),a("span",{class:"line-number"},"137"),a("br"),a("span",{class:"line-number"},"138"),a("br"),a("span",{class:"line-number"},"139"),a("br"),a("span",{class:"line-number"},"140"),a("br"),a("span",{class:"line-number"},"141"),a("br"),a("span",{class:"line-number"},"142"),a("br"),a("span",{class:"line-number"},"143"),a("br"),a("span",{class:"line-number"},"144"),a("br"),a("span",{class:"line-number"},"145"),a("br"),a("span",{class:"line-number"},"146"),a("br"),a("span",{class:"line-number"},"147"),a("br"),a("span",{class:"line-number"},"148"),a("br"),a("span",{class:"line-number"},"149"),a("br"),a("span",{class:"line-number"},"150"),a("br"),a("span",{class:"line-number"},"151"),a("br"),a("span",{class:"line-number"},"152"),a("br"),a("span",{class:"line-number"},"153"),a("br")])],-1);c.render=function(s,a,t,l,c,B){return n(),e("div",null,[o,i,r,p,u,d,m,b,k,y,h,g,_,f,T,v,A,C,E,S,I,w,j,O,P,R,U,x,D,L,N])};export default c;export{l as __pageData};
