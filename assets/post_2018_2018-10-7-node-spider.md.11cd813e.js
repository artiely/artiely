import{o as n,c as s,f as t,a,x as e}from"./app.b304d650.js";const c='{"title":"网络爬虫开发","description":"","frontmatter":{"title":"网络爬虫开发","tag":["nodejs","http","cheerio","selenium","puppeteer"],"author":"Artiely","date":"2018-10-7","cover":"https://gitee.com/artiely/Figure-bed/raw/master/images/20200315163511.png","base64":"fff"},"headers":[{"level":2,"title":"什么是爬虫","slug":"什么是爬虫"},{"level":2,"title":"爬虫的意义","slug":"爬虫的意义"},{"level":2,"title":"内容及目标","slug":"内容及目标"},{"level":2,"title":"前置知识","slug":"前置知识"},{"level":2,"title":"发送一个HTTP请求","slug":"发送一个http请求"},{"level":3,"title":"node官方api","slug":"node官方api"},{"level":3,"title":"发送http请求案例","slug":"发送http请求案例"},{"level":2,"title":"将获取的HTML字符串使用cheerio解析","slug":"将获取的html字符串使用cheerio解析"},{"level":3,"title":"cheerio库简介","slug":"cheerio库简介"},{"level":3,"title":"使用cheerio库解析HTML","slug":"使用cheerio库解析html"},{"level":2,"title":"使用download库批量下载图片","slug":"使用download库批量下载图片"},{"level":2,"title":"爬取新闻信息","slug":"爬取新闻信息"},{"level":2,"title":"封装爬虫基础库","slug":"封装爬虫基础库"},{"level":2,"title":"Selenium简介","slug":"selenium简介"},{"level":2,"title":"Selenium的基本使用","slug":"selenium的基本使用"},{"level":3,"title":"根据平台选择webdriver","slug":"根据平台选择webdriver"},{"level":3,"title":"安装selenium-webdriver的包","slug":"安装selenium-webdriver的包"},{"level":3,"title":"自动打开百度搜索“前端程序员“","slug":"自动打开百度搜索前端程序员"},{"level":2,"title":"使用Selenium实现爬虫","slug":"使用selenium实现爬虫"},{"level":3,"title":"为什么要用Selenium来做爬虫","slug":"为什么要用selenium来做爬虫"},{"level":3,"title":"Selenium API学习","slug":"selenium-api学习"},{"level":3,"title":"自动打开拉勾网搜索\\"前端\\"","slug":"自动打开拉勾网搜索前端"},{"level":3,"title":"获取需要的数据","slug":"获取需要的数据"},{"level":3,"title":"自动翻页","slug":"自动翻页"}],"relativePath":"post/2018/2018-10-7-node-spider.md","lastUpdated":1629110799524}',o={},p=t('<h1 id="网络爬虫开发"><a class="header-anchor" href="#网络爬虫开发" aria-hidden="true">#</a> 网络爬虫开发</h1><h2 id="什么是爬虫"><a class="header-anchor" href="#什么是爬虫" aria-hidden="true">#</a> 什么是爬虫</h2><p>可以把互联网比做成一张“大网”，爬虫就是在这张大网上不断爬取信息的程序</p><p>所以一句话总结：<strong>爬虫是请求网站并提取数据的自动化程序</strong></p><p>爬虫的基本工作流程如下：</p><ol><li>向指定的URL发送http请求</li><li>获取响应（HTML、XML、JSON、二进制等数据）</li><li>处理数据（解析DOM、解析JSON等）</li><li>将处理好的数据进行存储</li></ol><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165104.jpg" alt="img"></p><h2 id="爬虫的意义"><a class="header-anchor" href="#爬虫的意义" aria-hidden="true">#</a> 爬虫的意义</h2><p>爬虫就是一个探测程序，它的基本功能就是模拟人的行为去各个网站转悠，点点按钮，找找数据，或者把看到的信息背回来。就像一只虫子在一幢楼里不知疲倦地爬来爬去。</p><p>你可以简单地想象：<strong>每个爬虫都是你的“分身”。就像孙悟空拔了一撮汗毛，吹出一堆猴子一样。</strong></p><p>你每天使用的百度和Google，其实就是利用了这种爬虫技术：每天放出无数爬虫到各个网站，把他们的信息抓回来，存到数据库中等你来检索。</p><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165105.jpg" alt="img">抢票软件，就相当于撒出去无数个分身，每一个分身都帮助你不断刷新 12306 网站的火车余票。一旦发现有票，就马上下单，然后对你喊：大爷快来付款呀。</p><p>在现实中几乎所有行业的网站都会被爬虫所 “骚扰”，而这些骚扰都是为了方便用户</p><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165106.png" alt="1562640698673"></p><p>当然，有些网站是不能被过分骚扰的，其中排第一的就是出行类行业。</p><p>12306之所以会出如此变态的验证码，就是因为被爬虫折磨的无可奈何</p><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165107.jpg" alt="img"></p><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165108.jpg" alt="img"></p><p>正所谓道高一尺魔高一丈，某些爬虫工具，为了解决这种变态验证码，甚至推出了“打码平台”</p><p>原理就是爬虫还是不断工作，但只要遇到二维码，就通过打码平台下发任务，打码平台另一边就雇佣一大堆网络闲人，只要看到有验证码来了，就人工选一下验证码，完美的让程序与人工结合！</p><h2 id="内容及目标"><a class="header-anchor" href="#内容及目标" aria-hidden="true">#</a> 内容及目标</h2><ol><li>爬虫简介</li><li>制作一个自动下载图片的小爬虫</li><li>使用Selenium爬取动态网站</li></ol><h2 id="前置知识"><a class="header-anchor" href="#前置知识" aria-hidden="true">#</a> 前置知识</h2><ol><li>js基础</li><li>node基础</li></ol><h1 id="爬虫基础"><a class="header-anchor" href="#爬虫基础" aria-hidden="true">#</a> 爬虫基础</h1><p>学习目标:</p><ul><li>以<code>http://www.meizitu.com</code>网站目标为例，最终目的是下载网站中所有妹子的照片：</li></ul><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314163724.png" alt=""></p><p>下载所有妹子的照片，需要通过如下步骤实现：</p><ol><li>发送http请求，获取整个网页内容</li><li>通过cheerio库对网页内容进行分析</li><li>提取img标签的src属性</li><li>使用download库进行批量图片下载</li></ol><h2 id="发送一个http请求"><a class="header-anchor" href="#发送一个http请求" aria-hidden="true">#</a> 发送一个HTTP请求</h2><p>学习目标：</p><ul><li>发送HTTP请求并获取相应</li></ul><p>在学习爬虫之前，需要对HTTP请求充分了解，因为爬虫的原理就是发送请求到指定URL，获取响应后并处理</p><h3 id="node官方api"><a class="header-anchor" href="#node官方api" aria-hidden="true">#</a> node官方api</h3><p>node的核心模块 http模块即可发送请求，摘自node官网api：</p><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165109.png" alt="1562842951982"></p><p>由此可见只需要使用<code>http.request()</code>方法即可发送http请求</p><h3 id="发送http请求案例"><a class="header-anchor" href="#发送http请求案例" aria-hidden="true">#</a> 发送http请求案例</h3><p>也可以使用<code>axios</code>库来代替</p><p>代码如下：</p>',41),l=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token comment"},"// 引入http模块"),e("\n"),a("span",{class:"token keyword"},"const"),e(" http "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'http'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token comment"},"// 创建请求对象"),e("\n"),a("span",{class:"token keyword"},"let"),e(" req "),a("span",{class:"token operator"},"="),e(" http"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"request"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'https://www.meizitu.com/a/5521.html'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token parameter"},"res"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token comment"},"// 准备chunks"),e("\n  "),a("span",{class:"token keyword"},"let"),e(" chunks "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token punctuation"},"["),a("span",{class:"token punctuation"},"]"),e("\n  res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'data'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token parameter"},"chunk"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token comment"},"// 监听到数据就存储"),e("\n    chunks"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"push"),a("span",{class:"token punctuation"},"("),e("chunk"),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n  res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'end'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token comment"},"// 结束数据监听时讲所有内容拼接"),e("\n    console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),e("Buffer"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"concat"),a("span",{class:"token punctuation"},"("),e("chunks"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"toString"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'utf-8'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token comment"},"// 发送请求"),e("\nreq"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"end"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752776-3576"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// 引入http模块\nconst http = require('http')\n// 创建请求对象\nlet req = http.request('https://www.meizitu.com/a/5521.html', res => {\n  // 准备chunks\n  let chunks = []\n  res.on('data', chunk => {\n    // 监听到数据就存储\n    chunks.push(chunk)\n  })\n  res.on('end', () => {\n    // 结束数据监听时讲所有内容拼接\n    console.log(Buffer.concat(chunks).toString('utf-8'))\n  })\n})\n// 发送请求\nreq.end()\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752776-3576","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br")])],-1),i=t('<p>得到的结果就是整个HTML网页内容</p><h2 id="将获取的html字符串使用cheerio解析"><a class="header-anchor" href="#将获取的html字符串使用cheerio解析" aria-hidden="true">#</a> 将获取的HTML字符串使用cheerio解析</h2><p>目标：</p><ul><li>使用cheerio加载HTML</li><li>回顾jQueryAPI</li><li>加载所有的img标签的src属性</li></ul><h3 id="cheerio库简介"><a class="header-anchor" href="#cheerio库简介" aria-hidden="true">#</a> cheerio库简介</h3><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165110.png" alt="1562843968162"></p><blockquote><p>这是一个核心api按照jquery来设计，专门在服务器上使用，一个微小、快速和优雅的实现</p></blockquote><p>简而言之，就是可以再服务器上用这个库来解析HTML代码，并且可以直接使用和jQuery一样的api</p><p>官方demo如下：</p>',9),u=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"const"),e(" cheerio "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'cheerio'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token keyword"},"const"),e(" $ "),a("span",{class:"token operator"},"="),e(" cheerio"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"load"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'<h2 class=\"title\">Hello world</h2>'"),a("span",{class:"token punctuation"},")"),e("\n \n"),a("span",{class:"token function"},"$"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'h2.title'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"text"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'Hello there!'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token function"},"$"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'h2'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"addClass"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'welcome'"),a("span",{class:"token punctuation"},")"),e("\n \n$"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"html"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token comment"},'//=> <html><head></head><body><h2 class="title welcome">Hello there!</h2></body></html>'),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752776-137"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const cheerio = require('cheerio')\nconst $ = cheerio.load('<h2 class=\"title\">Hello world</h2>')\n \n$('h2.title').text('Hello there!')\n$('h2').addClass('welcome')\n \n$.html()\n//=> <html><head></head><body><h2 class=\"title welcome\">Hello there!</h2></body></html>\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752776-137","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br")])],-1),r=a("p",null,"同样也可以通过jQuery的api来获取DOM元素中的属性和内容",-1),k=a("h3",{id:"使用cheerio库解析html"},[a("a",{class:"header-anchor",href:"#使用cheerio库解析html","aria-hidden":"true"},"#"),e(" 使用cheerio库解析HTML")],-1),d=a("ol",null,[a("li",null,"分析网页中所有img标签所在结构")],-1),m=a("p",null,[a("img",{src:"https://gitee.com/artiely/Figure-bed/raw/master/images/20200314163928.png",alt:""})],-1),b=a("ol",{start:"2"},[a("li",null,"使用jQuery API获取所有img的src属性")],-1),y=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"const"),e(" http "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'http'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token keyword"},"const"),e(" cheerio "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'cheerio'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token keyword"},"let"),e(" req "),a("span",{class:"token operator"},"="),e(" http"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"request"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'https://www.meizitu.com/a/5521.html'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token parameter"},"res"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token keyword"},"let"),e(" chunks "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token punctuation"},"["),a("span",{class:"token punctuation"},"]"),e("\n  res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'data'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token parameter"},"chunk"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n    chunks"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"push"),a("span",{class:"token punctuation"},"("),e("chunk"),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n  res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'end'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token comment"},"// console.log(Buffer.concat(chunks).toString('utf-8'))"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" html "),a("span",{class:"token operator"},"="),e(" Buffer"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"concat"),a("span",{class:"token punctuation"},"("),e("chunks"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"toString"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'utf-8'"),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" $ "),a("span",{class:"token operator"},"="),e(" cheerio"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"load"),a("span",{class:"token punctuation"},"("),e("html"),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" imgArr "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token class-name"},"Array"),a("span",{class:"token punctuation"},"."),e("prototype"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"map"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"call"),a("span",{class:"token punctuation"},"("),a("span",{class:"token function"},"$"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'#picture > img'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"("),a("span",{class:"token parameter"},"item"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token function"},"$"),a("span",{class:"token punctuation"},"("),e("item"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"attr"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'src'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n    console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),e("imgArr"),a("span",{class:"token punctuation"},")"),e("\n    \n  "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n\nreq"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"end"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752776-59257"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const http = require('http')\nconst cheerio = require('cheerio')\nlet req = http.request('https://www.meizitu.com/a/5521.html', res => {\n  let chunks = []\n  res.on('data', chunk => {\n    chunks.push(chunk)\n  })\n  res.on('end', () => {\n    // console.log(Buffer.concat(chunks).toString('utf-8'))\n    let html = Buffer.concat(chunks).toString('utf-8')\n    let $ = cheerio.load(html)\n    let imgArr = Array.prototype.map.call($('#picture > img'), (item) => $(item).attr('src'))\n    console.log(imgArr)\n    \n  })\n})\n\nreq.end()\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752776-59257","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br")])],-1),f=a("h2",{id:"使用download库批量下载图片"},[a("a",{class:"header-anchor",href:"#使用download库批量下载图片","aria-hidden":"true"},"#"),e(" 使用download库批量下载图片")],-1),h=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"const"),e(" http "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'http'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token keyword"},"const"),e(" cheerio "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'cheerio'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token keyword"},"const"),e(" download "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'download'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token keyword"},"let"),e(" req "),a("span",{class:"token operator"},"="),e(" http"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"request"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'http://xxx'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token parameter"},"res"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token keyword"},"let"),e(" chunks "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token punctuation"},"["),a("span",{class:"token punctuation"},"]"),e("\n  res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'data'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token parameter"},"chunk"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n    chunks"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"push"),a("span",{class:"token punctuation"},"("),e("chunk"),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n  res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'end'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token comment"},"// console.log(Buffer.concat(chunks).toString('utf-8'))"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" html "),a("span",{class:"token operator"},"="),e(" Buffer"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"concat"),a("span",{class:"token punctuation"},"("),e("chunks"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"toString"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'utf-8'"),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" $ "),a("span",{class:"token operator"},"="),e(" cheerio"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"load"),a("span",{class:"token punctuation"},"("),e("html"),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" imgArr "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token class-name"},"Array"),a("span",{class:"token punctuation"},"."),e("prototype"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"map"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"call"),a("span",{class:"token punctuation"},"("),a("span",{class:"token function"},"$"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'xx > img'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"("),a("span",{class:"token parameter"},"item"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token function"},"encodeURI"),a("span",{class:"token punctuation"},"("),a("span",{class:"token function"},"$"),a("span",{class:"token punctuation"},"("),e("item"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"attr"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'src'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token comment"},"// console.log(imgArr)"),e("\n\n    Promise"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"all"),a("span",{class:"token punctuation"},"("),e("imgArr"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"map"),a("span",{class:"token punctuation"},"("),a("span",{class:"token parameter"},"x"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token function"},"download"),a("span",{class:"token punctuation"},"("),e("x"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token string"},"'dist'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"then"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n      console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'files downloaded!'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n    "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n\nreq"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"end"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752776-78910"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const http = require('http')\nconst cheerio = require('cheerio')\nconst download = require('download')\nlet req = http.request('http://xxx', res => {\n  let chunks = []\n  res.on('data', chunk => {\n    chunks.push(chunk)\n  })\n  res.on('end', () => {\n    // console.log(Buffer.concat(chunks).toString('utf-8'))\n    let html = Buffer.concat(chunks).toString('utf-8')\n    let $ = cheerio.load(html)\n    let imgArr = Array.prototype.map.call($('xx > img'), (item) => encodeURI($(item).attr('src')))\n    // console.log(imgArr)\n\n    Promise.all(imgArr.map(x => download(x, 'dist'))).then(() => {\n      console.log('files downloaded!');\n    });\n  })\n})\n\nreq.end()\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752776-78910","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br")])],-1),g=a("p",null,"注意事项：如有中文文件名，需要使用base64编码",-1),w=a("h2",{id:"爬取新闻信息"},[a("a",{class:"header-anchor",href:"#爬取新闻信息","aria-hidden":"true"},"#"),e(" 爬取新闻信息")],-1),_=a("p",null,"大部分新闻网站，现在都采取前后端分离的方式，也就是前端页面先写好模板，等网页加载完毕后，发送Ajax再获取数据，将其渲染到模板中。所以如果使用相同方式来获取目标网站的HTML页面，请求到的只是模板，并不会有数据：",-1),C=a("p",null,[a("img",{src:"https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165111.png",alt:"1563271689010"})],-1),v=a("p",null,"此时，如果还希望使用当前方法爬取数据，就需要分析该网站的ajax请求是如何发送的，可以打开network面板来调试：",-1),x=a("p",null,"分析得出对应的ajax请求后，找到其URL，向其发送请求即可",-1),E=a("p",null,"代码如下：",-1),T=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token comment"},"// 引入http模块"),e("\n"),a("span",{class:"token keyword"},"const"),e(" http "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'http'"),a("span",{class:"token punctuation"},")"),e("\n\n"),a("span",{class:"token comment"},"// 创建请求对象 (此时未发送http请求)"),e("\n"),a("span",{class:"token keyword"},"const"),e(" url "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token string"},"'http://xxx'"),e("\n"),a("span",{class:"token keyword"},"let"),e(" req "),a("span",{class:"token operator"},"="),e(" http"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"request"),a("span",{class:"token punctuation"},"("),e("url"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token parameter"},"res"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token comment"},"// 异步的响应"),e("\n  "),a("span",{class:"token comment"},"// console.log(res)"),e("\n  "),a("span",{class:"token keyword"},"let"),e(" chunks "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token punctuation"},"["),a("span",{class:"token punctuation"},"]"),e("\n  "),a("span",{class:"token comment"},"// 监听data事件,获取传递过来的数据片段"),e("\n  "),a("span",{class:"token comment"},"// 拼接数据片段"),e("\n  res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'data'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token parameter"},"c"),e(),a("span",{class:"token operator"},"=>"),e(" chunks"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"push"),a("span",{class:"token punctuation"},"("),e("c"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n\n  "),a("span",{class:"token comment"},"// 监听end事件,获取数据完毕时触发"),e("\n  res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'end'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token comment"},"// 拼接所有的chunk,并转换成字符串 ==> html字符串"),e("\n    "),a("span",{class:"token comment"},"// console.log(Buffer.concat(chunks).toString('utf-8'))"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" result "),a("span",{class:"token operator"},"="),e(" Buffer"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"concat"),a("span",{class:"token punctuation"},"("),e("chunks"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"toString"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'utf-8'"),a("span",{class:"token punctuation"},")"),e("\n    console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),a("span",{class:"token constant"},"JSON"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"parse"),a("span",{class:"token punctuation"},"("),e("result"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n\n"),a("span",{class:"token comment"},"// 将请求发出去"),e("\nreq"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"end"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752777-19061"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// 引入http模块\nconst http = require('http')\n\n// 创建请求对象 (此时未发送http请求)\nconst url = 'http://xxx'\nlet req = http.request(url, res => {\n  // 异步的响应\n  // console.log(res)\n  let chunks = []\n  // 监听data事件,获取传递过来的数据片段\n  // 拼接数据片段\n  res.on('data', c => chunks.push(c))\n\n  // 监听end事件,获取数据完毕时触发\n  res.on('end', () => {\n    // 拼接所有的chunk,并转换成字符串 ==> html字符串\n    // console.log(Buffer.concat(chunks).toString('utf-8'))\n    let result = Buffer.concat(chunks).toString('utf-8')\n    console.log(JSON.parse(result))\n  })\n})\n\n// 将请求发出去\nreq.end()\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752777-19061","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br")])],-1),A=a("p",null,"如果遇到请求限制，还可以模拟真实浏览器的请求头：",-1),B=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token comment"},"// 引入http模块"),e("\n"),a("span",{class:"token keyword"},"const"),e(" http "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'http'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token keyword"},"const"),e(" cheerio "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'cheerio'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token keyword"},"const"),e(" download "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'download'"),a("span",{class:"token punctuation"},")"),e("\n\n"),a("span",{class:"token comment"},"// 创建请求对象 (此时未发送http请求)"),e("\n"),a("span",{class:"token keyword"},"const"),e(" url "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token string"},"'http://www.xx'"),e("\n"),a("span",{class:"token keyword"},"let"),e(" req "),a("span",{class:"token operator"},"="),e(" http"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"request"),a("span",{class:"token punctuation"},"("),e("url"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"{"),e("\n  headers"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token string"},'"Host"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"www.xx.cn"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Connection"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"keep-alive"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Content-Length"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"0"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Accept"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"*/*"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Origin"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"http://www.xx.cn"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"X-Requested-With"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"XMLHttpRequest"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"User-Agent"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"DNT"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"1"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Referer"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"http://www.xx.cn/newsvideo/newslist.html"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Accept-Encoding"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"gzip, deflate"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Accept-Language"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"zh-CN,zh;q=0.9,en;q=0.8"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Cookie"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"UM_distinctid=16b8a0c1ea534c-0c311b256ffee7-e343166-240000-16b8a0c1ea689c; bad_idb2f10070-624e-11e8-917f-9fb8db4dc43c=8e1dcca1-9692-11e9-97fb-e5908bcaecf8; parent_qimo_sid_b2f10070-624e-11e8-917f-9fb8db4dc43c=921b3900-9692-11e9-9a47-855e632e21e7; CNZZDATA1277769855=1043056636-1562825067-null%7C1562825067; cid_litiancheng_xx.cn=TUd3emFUWjBNV2syWVRCdU5XTTRhREZs; PHPSESSID=j3ppafq1dgh2jfg6roc8eeljg2; CNZZDATA4617777=cnzz_eid%3D926291424-1561388898-http%253A%252F%252Fmail.x.cn%252F%26ntime%3D1563262791; Hm_lvt_0cb375a2e834821b74efffa6c71ee607=1561389179,1563266246; qimo_seosource_22bdcd10-6250-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_22bdcd10-6250-11e8-917f-9fb8db4dc43c=; href=http%3A%2F%2Fwww.xx.cn%2F; bad_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b71-a7a4-11e9-93cc-9b702389a8cb; nice_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b72-a7a4-11e9-93cc-9b702389a8cb; openChat22bdcd10-6250-11e8-917f-9fb8db4dc43c=true; parent_qimo_sid_22bdcd10-6250-11e8-917f-9fb8db4dc43c=fc61e520-a7a4-11e9-94a8-01dabdc2ed41; qimo_seosource_b2f10070-624e-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_b2f10070-624e-11e8-917f-9fb8db4dc43c=; accessId=b2f10070-624e-11e8-917f-9fb8db4dc43c; pageViewNum=2; nice_idb2f10070-624e-11e8-917f-9fb8db4dc43c=20d2a1d1-a7a8-11e9-bc20-e71d1b8e4bb6; openChatb2f10070-624e-11e8-917f-9fb8db4dc43c=true; Hm_lpvt_0cb375a2e834821b74efffa6c71ee607=1563267937"'),e("\n  "),a("span",{class:"token punctuation"},"}"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token parameter"},"res"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token comment"},"// 异步的响应"),e("\n  "),a("span",{class:"token comment"},"// console.log(res)"),e("\n  "),a("span",{class:"token keyword"},"let"),e(" chunks "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token punctuation"},"["),a("span",{class:"token punctuation"},"]"),e("\n  "),a("span",{class:"token comment"},"// 监听data事件,获取传递过来的数据片段"),e("\n  "),a("span",{class:"token comment"},"// 拼接数据片段"),e("\n  res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'data'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token parameter"},"c"),e(),a("span",{class:"token operator"},"=>"),e(" chunks"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"push"),a("span",{class:"token punctuation"},"("),e("c"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n\n  "),a("span",{class:"token comment"},"// 监听end事件,获取数据完毕时触发"),e("\n  res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'end'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token comment"},"// 拼接所有的chunk,并转换成字符串 ==> html字符串"),e("\n    "),a("span",{class:"token comment"},"// console.log(Buffer.concat(chunks).toString('utf-8'))"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" result "),a("span",{class:"token operator"},"="),e(" Buffer"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"concat"),a("span",{class:"token punctuation"},"("),e("chunks"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"toString"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'utf-8'"),a("span",{class:"token punctuation"},")"),e("\n    console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),a("span",{class:"token constant"},"JSON"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"parse"),a("span",{class:"token punctuation"},"("),e("result"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n\n"),a("span",{class:"token comment"},"// 将请求发出去"),e("\nreq"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"end"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752777-1535"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'// 引入http模块\nconst http = require(\'http\')\nconst cheerio = require(\'cheerio\')\nconst download = require(\'download\')\n\n// 创建请求对象 (此时未发送http请求)\nconst url = \'http://www.xx\'\nlet req = http.request(url, {\n  headers: {\n    "Host": "www.xx.cn",\n    "Connection": "keep-alive",\n    "Content-Length": "0",\n    "Accept": "*/*",\n    "Origin": "http://www.xx.cn",\n    "X-Requested-With": "XMLHttpRequest",\n    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36",\n    "DNT": "1",\n    "Referer": "http://www.xx.cn/newsvideo/newslist.html",\n    "Accept-Encoding": "gzip, deflate",\n    "Accept-Language": "zh-CN,zh;q=0.9,en;q=0.8",\n    "Cookie": "UM_distinctid=16b8a0c1ea534c-0c311b256ffee7-e343166-240000-16b8a0c1ea689c; bad_idb2f10070-624e-11e8-917f-9fb8db4dc43c=8e1dcca1-9692-11e9-97fb-e5908bcaecf8; parent_qimo_sid_b2f10070-624e-11e8-917f-9fb8db4dc43c=921b3900-9692-11e9-9a47-855e632e21e7; CNZZDATA1277769855=1043056636-1562825067-null%7C1562825067; cid_litiancheng_xx.cn=TUd3emFUWjBNV2syWVRCdU5XTTRhREZs; PHPSESSID=j3ppafq1dgh2jfg6roc8eeljg2; CNZZDATA4617777=cnzz_eid%3D926291424-1561388898-http%253A%252F%252Fmail.x.cn%252F%26ntime%3D1563262791; Hm_lvt_0cb375a2e834821b74efffa6c71ee607=1561389179,1563266246; qimo_seosource_22bdcd10-6250-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_22bdcd10-6250-11e8-917f-9fb8db4dc43c=; href=http%3A%2F%2Fwww.xx.cn%2F; bad_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b71-a7a4-11e9-93cc-9b702389a8cb; nice_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b72-a7a4-11e9-93cc-9b702389a8cb; openChat22bdcd10-6250-11e8-917f-9fb8db4dc43c=true; parent_qimo_sid_22bdcd10-6250-11e8-917f-9fb8db4dc43c=fc61e520-a7a4-11e9-94a8-01dabdc2ed41; qimo_seosource_b2f10070-624e-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_b2f10070-624e-11e8-917f-9fb8db4dc43c=; accessId=b2f10070-624e-11e8-917f-9fb8db4dc43c; pageViewNum=2; nice_idb2f10070-624e-11e8-917f-9fb8db4dc43c=20d2a1d1-a7a8-11e9-bc20-e71d1b8e4bb6; openChatb2f10070-624e-11e8-917f-9fb8db4dc43c=true; Hm_lpvt_0cb375a2e834821b74efffa6c71ee607=1563267937"\n  }\n}, res => {\n  // 异步的响应\n  // console.log(res)\n  let chunks = []\n  // 监听data事件,获取传递过来的数据片段\n  // 拼接数据片段\n  res.on(\'data\', c => chunks.push(c))\n\n  // 监听end事件,获取数据完毕时触发\n  res.on(\'end\', () => {\n    // 拼接所有的chunk,并转换成字符串 ==> html字符串\n    // console.log(Buffer.concat(chunks).toString(\'utf-8\'))\n    let result = Buffer.concat(chunks).toString(\'utf-8\')\n    console.log(JSON.parse(result))\n  })\n})\n\n// 将请求发出去\nreq.end()\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752777-1535","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br"),a("span",{class:"line-number"},"27"),a("br"),a("span",{class:"line-number"},"28"),a("br"),a("span",{class:"line-number"},"29"),a("br"),a("span",{class:"line-number"},"30"),a("br"),a("span",{class:"line-number"},"31"),a("br"),a("span",{class:"line-number"},"32"),a("br"),a("span",{class:"line-number"},"33"),a("br"),a("span",{class:"line-number"},"34"),a("br"),a("span",{class:"line-number"},"35"),a("br"),a("span",{class:"line-number"},"36"),a("br"),a("span",{class:"line-number"},"37"),a("br"),a("span",{class:"line-number"},"38"),a("br"),a("span",{class:"line-number"},"39"),a("br"),a("span",{class:"line-number"},"40"),a("br"),a("span",{class:"line-number"},"41"),a("br")])],-1),S=a("p",null,"注意：请求头的内容，可以先通过真正的浏览器访问一次后获取",-1),D=a("h2",{id:"封装爬虫基础库"},[a("a",{class:"header-anchor",href:"#封装爬虫基础库","aria-hidden":"true"},"#"),e(" 封装爬虫基础库")],-1),N=a("p",null,"以上代码重复的地方非常多，可以考虑以面向对象的思想进行封装，进一步的提高代码复用率，为了方便开发，保证代码规范，建议使用TypeScript进行封装",-1),q=a("p",null,[a("strong",null,"以下知识点为扩展内容，需要对面向对象和TypeScript有一定了解！")],-1),j=a("p",null,[e("执行"),a("code",null,"tsc --init"),e("初始化项目，生成ts配置文件")],-1),F=a("p",null,"TS配置：",-1),P=a("div",{class:"language-json line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token property"},'"compilerOptions"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token comment"},"/* Basic Options */"),e("\n    "),a("span",{class:"token property"},'"target"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"es2015"'),a("span",{class:"token punctuation"},","),e(" \n    "),a("span",{class:"token property"},'"module"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"commonjs"'),a("span",{class:"token punctuation"},","),e(" \n    "),a("span",{class:"token property"},'"outDir"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"./bin"'),a("span",{class:"token punctuation"},","),e(" \n    "),a("span",{class:"token property"},'"rootDir"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"./src"'),a("span",{class:"token punctuation"},","),e(" \n    "),a("span",{class:"token property"},'"strict"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token boolean"},"true"),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token property"},'"esModuleInterop"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token boolean"},"true"),e(" \n  "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},","),e("\n  "),a("span",{class:"token property"},'"include"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token punctuation"},"["),e("\n    "),a("span",{class:"token string"},'"src/**/*"'),e("\n  "),a("span",{class:"token punctuation"},"]"),a("span",{class:"token punctuation"},","),e("\n  "),a("span",{class:"token property"},'"exclude"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token punctuation"},"["),e("\n    "),a("span",{class:"token string"},'"node_modules"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"**/*.spec.ts"'),e("\n  "),a("span",{class:"token punctuation"},"]"),e("\n"),a("span",{class:"token punctuation"},"}"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752777-10938"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'{\n  "compilerOptions": {\n    /* Basic Options */\n    "target": "es2015", \n    "module": "commonjs", \n    "outDir": "./bin", \n    "rootDir": "./src", \n    "strict": true,\n    "esModuleInterop": true \n  },\n  "include": [\n    "src/**/*"\n  ],\n  "exclude": [\n    "node_modules",\n    "**/*.spec.ts"\n  ]\n}\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752777-10938","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br")])],-1),I=a("p",null,"Spider抽象类：",-1),$=a("div",{class:"language-ts line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token comment"},"// 引入http模块"),e("\n"),a("span",{class:"token keyword"},"const"),e(" http "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'http'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token keyword"},"import"),e(" SpiderOptions "),a("span",{class:"token keyword"},"from"),e(),a("span",{class:"token string"},"'./interfaces/SpiderOptions'"),e("\n\n"),a("span",{class:"token keyword"},"export"),e(),a("span",{class:"token keyword"},"default"),e(),a("span",{class:"token keyword"},"abstract"),e(),a("span",{class:"token keyword"},"class"),e(),a("span",{class:"token class-name"},"Spider"),e(),a("span",{class:"token punctuation"},"{"),e("\n  options"),a("span",{class:"token operator"},":"),e(" SpiderOptions"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token function"},"constructor"),a("span",{class:"token punctuation"},"("),e("options"),a("span",{class:"token operator"},":"),e(" SpiderOptions "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token punctuation"},"{"),e(" url"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},"''"),a("span",{class:"token punctuation"},","),e(" method"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},"'get'"),e(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token keyword"},"this"),a("span",{class:"token punctuation"},"."),e("options "),a("span",{class:"token operator"},"="),e(" options\n    "),a("span",{class:"token keyword"},"this"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"start"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token punctuation"},"}"),e("\n  "),a("span",{class:"token function"},"start"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token keyword"},"void"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token comment"},"// 创建请求对象 (此时未发送http请求)"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" req "),a("span",{class:"token operator"},"="),e(" http"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"request"),a("span",{class:"token punctuation"},"("),a("span",{class:"token keyword"},"this"),a("span",{class:"token punctuation"},"."),e("options"),a("span",{class:"token punctuation"},"."),e("url"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"{"),e("\n      headers"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token keyword"},"this"),a("span",{class:"token punctuation"},"."),e("options"),a("span",{class:"token punctuation"},"."),e("headers"),a("span",{class:"token punctuation"},","),e("\n      method"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token keyword"},"this"),a("span",{class:"token punctuation"},"."),e("options"),a("span",{class:"token punctuation"},"."),e("method\n    "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"("),e("res"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token builtin"},"any"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n      "),a("span",{class:"token comment"},"// 异步的响应"),e("\n      "),a("span",{class:"token comment"},"// console.log(res)"),e("\n      "),a("span",{class:"token keyword"},"let"),e(" chunks"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token builtin"},"any"),a("span",{class:"token punctuation"},"["),a("span",{class:"token punctuation"},"]"),e(),a("span",{class:"token operator"},"="),e(),a("span",{class:"token punctuation"},"["),a("span",{class:"token punctuation"},"]"),e("\n      "),a("span",{class:"token comment"},"// 监听data事件,获取传递过来的数据片段"),e("\n      "),a("span",{class:"token comment"},"// 拼接数据片段"),e("\n      res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'data'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"("),e("c"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token builtin"},"any"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(" chunks"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"push"),a("span",{class:"token punctuation"},"("),e("c"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n\n      "),a("span",{class:"token comment"},"// 监听end事件,获取数据完毕时触发"),e("\n      res"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"on"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'end'"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n        "),a("span",{class:"token comment"},"// 拼接所有的chunk,并转换成字符串 ==> html字符串"),e("\n        "),a("span",{class:"token keyword"},"let"),e(" htmlStr "),a("span",{class:"token operator"},"="),e(" Buffer"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"concat"),a("span",{class:"token punctuation"},"("),e("chunks"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"toString"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'utf-8'"),a("span",{class:"token punctuation"},")"),e("\n        "),a("span",{class:"token keyword"},"this"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"onCatchHTML"),a("span",{class:"token punctuation"},"("),e("htmlStr"),a("span",{class:"token punctuation"},")"),e("\n      "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n\n    "),a("span",{class:"token comment"},"// 将请求发出去"),e("\n    req"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"end"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n\n  "),a("span",{class:"token punctuation"},"}"),e("\n  "),a("span",{class:"token keyword"},"abstract"),e(),a("span",{class:"token function"},"onCatchHTML"),a("span",{class:"token punctuation"},"("),e("result"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token builtin"},"string"),a("span",{class:"token punctuation"},")"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token builtin"},"any"),e("\n"),a("span",{class:"token punctuation"},"}"),e("\n\n"),a("span",{class:"token keyword"},"export"),e(),a("span",{class:"token keyword"},"default"),e(" Spider\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752777-69588"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// 引入http模块\nconst http = require('http')\nimport SpiderOptions from './interfaces/SpiderOptions'\n\nexport default abstract class Spider {\n  options: SpiderOptions;\n  constructor(options: SpiderOptions = { url: '', method: 'get' }) {\n    this.options = options\n    this.start()\n  }\n  start(): void {\n    // 创建请求对象 (此时未发送http请求)\n    let req = http.request(this.options.url, {\n      headers: this.options.headers,\n      method: this.options.method\n    }, (res: any) => {\n      // 异步的响应\n      // console.log(res)\n      let chunks: any[] = []\n      // 监听data事件,获取传递过来的数据片段\n      // 拼接数据片段\n      res.on('data', (c: any) => chunks.push(c))\n\n      // 监听end事件,获取数据完毕时触发\n      res.on('end', () => {\n        // 拼接所有的chunk,并转换成字符串 ==> html字符串\n        let htmlStr = Buffer.concat(chunks).toString('utf-8')\n        this.onCatchHTML(htmlStr)\n      })\n    })\n\n    // 将请求发出去\n    req.end()\n\n  }\n  abstract onCatchHTML(result: string): any\n}\n\nexport default Spider\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752777-69588","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br"),a("span",{class:"line-number"},"27"),a("br"),a("span",{class:"line-number"},"28"),a("br"),a("span",{class:"line-number"},"29"),a("br"),a("span",{class:"line-number"},"30"),a("br"),a("span",{class:"line-number"},"31"),a("br"),a("span",{class:"line-number"},"32"),a("br"),a("span",{class:"line-number"},"33"),a("br"),a("span",{class:"line-number"},"34"),a("br"),a("span",{class:"line-number"},"35"),a("br"),a("span",{class:"line-number"},"36"),a("br"),a("span",{class:"line-number"},"37"),a("br"),a("span",{class:"line-number"},"38"),a("br"),a("span",{class:"line-number"},"39"),a("br")])],-1),L=a("p",null,"SpiderOptions接口：",-1),H=a("div",{class:"language-ts line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"export"),e(),a("span",{class:"token keyword"},"default"),e(),a("span",{class:"token keyword"},"interface"),e(),a("span",{class:"token class-name"},"SpiderOptions"),e(),a("span",{class:"token punctuation"},"{"),e("\n  url"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token builtin"},"string"),a("span",{class:"token punctuation"},","),e("\n  method"),a("span",{class:"token operator"},"?"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token builtin"},"string"),a("span",{class:"token punctuation"},","),e("\n  headers"),a("span",{class:"token operator"},"?"),a("span",{class:"token operator"},":"),e(" object\n"),a("span",{class:"token punctuation"},"}"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752781-88630"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"export default interface SpiderOptions {\n  url: string,\n  method?: string,\n  headers?: object\n}\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752781-88630","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br")])],-1),R=a("p",null,"PhotoListSpider类：",-1),M=a("div",{class:"language-ts line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"import"),e(" Spider "),a("span",{class:"token keyword"},"from"),e(),a("span",{class:"token string"},"'./Spider'"),e("\n"),a("span",{class:"token keyword"},"const"),e(" cheerio "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'cheerio'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token keyword"},"const"),e(" download "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'download'"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token keyword"},"export"),e(),a("span",{class:"token keyword"},"default"),e(),a("span",{class:"token keyword"},"class"),e(),a("span",{class:"token class-name"},"PhotoListSpider"),e(),a("span",{class:"token keyword"},"extends"),e(),a("span",{class:"token class-name"},"Spider"),e(),a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token function"},"onCatchHTML"),a("span",{class:"token punctuation"},"("),e("result"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token builtin"},"string"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token comment"},"// console.log(result)"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" $ "),a("span",{class:"token operator"},"="),e(" cheerio"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"load"),a("span",{class:"token punctuation"},"("),e("result"),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" imgs "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token builtin"},"Array"),a("span",{class:"token punctuation"},"."),e("prototype"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"map"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"call"),a("span",{class:"token punctuation"},"("),a("span",{class:"token function"},"$"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.tea_main .tea_con .li_img > img'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},","),e(" item "),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token string"},"'http://web.xx.com/'"),e(),a("span",{class:"token operator"},"+"),e(),a("span",{class:"token function"},"encodeURI"),a("span",{class:"token punctuation"},"("),a("span",{class:"token function"},"$"),a("span",{class:"token punctuation"},"("),e("item"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"attr"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'src'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token builtin"},"Promise"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"all"),a("span",{class:"token punctuation"},"("),e("imgs"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"map"),a("span",{class:"token punctuation"},"("),e("x "),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token function"},"download"),a("span",{class:"token punctuation"},"("),e("x"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token string"},"'dist'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"then"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n      "),a("span",{class:"token builtin"},"console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'files downloaded!'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n    "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token punctuation"},"}"),e("\n"),a("span",{class:"token punctuation"},"}"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752781-6005"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"import Spider from './Spider'\nconst cheerio = require('cheerio')\nconst download = require('download')\nexport default class PhotoListSpider extends Spider {\n  onCatchHTML(result: string) {\n    // console.log(result)\n    let $ = cheerio.load(result)\n    let imgs = Array.prototype.map.call($('.tea_main .tea_con .li_img > img'), item => 'http://web.xx.com/' + encodeURI($(item).attr('src')))\n    Promise.all(imgs.map(x => download(x, 'dist'))).then(() => {\n      console.log('files downloaded!');\n    });\n  }\n}\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752781-6005","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br")])],-1),O=a("p",null,"NewsListSpider类：",-1),K=a("div",{class:"language-ts line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"import"),e(" Spider "),a("span",{class:"token keyword"},"from"),e(),a("span",{class:"token string"},'"./Spider"'),a("span",{class:"token punctuation"},";"),e("\n\n"),a("span",{class:"token keyword"},"export"),e(),a("span",{class:"token keyword"},"default"),e(),a("span",{class:"token keyword"},"class"),e(),a("span",{class:"token class-name"},"NewsListSpider"),e(),a("span",{class:"token keyword"},"extends"),e(),a("span",{class:"token class-name"},"Spider"),e(),a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token function"},"onCatchHTML"),a("span",{class:"token punctuation"},"("),e("result"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token builtin"},"string"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token builtin"},"console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),a("span",{class:"token constant"},"JSON"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"parse"),a("span",{class:"token punctuation"},"("),e("result"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token punctuation"},"}"),e("\n"),a("span",{class:"token punctuation"},"}"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752781-62971"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'import Spider from "./Spider";\n\nexport default class NewsListSpider extends Spider {\n  onCatchHTML(result: string) {\n    console.log(JSON.parse(result))\n  }\n}\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752781-62971","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br")])],-1),W=a("p",null,"测试类：",-1),U=a("div",{class:"language-ts line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"import"),e(" Spider "),a("span",{class:"token keyword"},"from"),e(),a("span",{class:"token string"},"'./Spider'"),e("\n"),a("span",{class:"token keyword"},"import"),e(" PhotoListSpider "),a("span",{class:"token keyword"},"from"),e(),a("span",{class:"token string"},"'./PhotoListSpider'"),e("\n"),a("span",{class:"token keyword"},"import"),e(" NewsListSpider "),a("span",{class:"token keyword"},"from"),e(),a("span",{class:"token string"},"'./NewsListSpider'"),e("\n\n"),a("span",{class:"token keyword"},"let"),e(" spider1"),a("span",{class:"token operator"},":"),e(" Spider "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"new"),e(),a("span",{class:"token class-name"},"PhotoListSpider"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),e("\n  url"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},"'http://web.xx.com/teacher.html'"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n\n"),a("span",{class:"token keyword"},"let"),e(" spider2"),a("span",{class:"token operator"},":"),e(" Spider "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"new"),e(),a("span",{class:"token class-name"},"NewsListSpider"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),e("\n  url"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},"'http://www.xx.cn/news/json/f1f5ccee-1158-49a6-b7c4-f0bf40d5161a.json'"),a("span",{class:"token punctuation"},","),e("\n  method"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},"'post'"),a("span",{class:"token punctuation"},","),e("\n  headers"),a("span",{class:"token operator"},":"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token string"},'"Host"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"www.xx.cn"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Connection"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"keep-alive"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Content-Length"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"0"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Accept"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"*/*"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Origin"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"http://www.xx.cn"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"X-Requested-With"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"XMLHttpRequest"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"User-Agent"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"DNT"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"1"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Referer"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"http://www.xx.cn/newsvideo/newslist.html"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Accept-Encoding"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"gzip, deflate"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Accept-Language"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"zh-CN,zh;q=0.9,en;q=0.8"'),a("span",{class:"token punctuation"},","),e("\n    "),a("span",{class:"token string"},'"Cookie"'),a("span",{class:"token operator"},":"),e(),a("span",{class:"token string"},'"UM_distinctid=16b8a0c1ea534c-0c311b256ffee7-e343166-240000-16b8a0c1ea689c; bad_idb2f10070-624e-11e8-917f-9fb8db4dc43c=8e1dcca1-9692-11e9-97fb-e5908bcaecf8; parent_qimo_sid_b2f10070-624e-11e8-917f-9fb8db4dc43c=921b3900-9692-11e9-9a47-855e632e21e7; CNZZDATA1277769855=1043056636-1562825067-null%7C1562825067; cid_litiancheng_xx.cn=TUd3emFUWjBNV2syWVRCdU5XTTRhREZs; PHPSESSID=j3ppafq1dgh2jfg6roc8eeljg2; CNZZDATA4617777=cnzz_eid%3D926291424-1561388898-http%253A%252F%252Fmail.xx.cn%252F%26ntime%3D1563262791; Hm_lvt_0cb375a2e834821b74efffa6c71ee607=1561389179,1563266246; qimo_seosource_22bdcd10-6250-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_22bdcd10-6250-11e8-917f-9fb8db4dc43c=; href=http%3A%2F%2Fwww.xx.cn%2F; bad_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b71-a7a4-11e9-93cc-9b702389a8cb; nice_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b72-a7a4-11e9-93cc-9b702389a8cb; openChat22bdcd10-6250-11e8-917f-9fb8db4dc43c=true; parent_qimo_sid_22bdcd10-6250-11e8-917f-9fb8db4dc43c=fc61e520-a7a4-11e9-94a8-01dabdc2ed41; qimo_seosource_b2f10070-624e-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_b2f10070-624e-11e8-917f-9fb8db4dc43c=; accessId=b2f10070-624e-11e8-917f-9fb8db4dc43c; pageViewNum=2; nice_idb2f10070-624e-11e8-917f-9fb8db4dc43c=20d2a1d1-a7a8-11e9-bc20-e71d1b8e4bb6; openChatb2f10070-624e-11e8-917f-9fb8db4dc43c=true; Hm_lpvt_0cb375a2e834821b74efffa6c71ee607=1563267937"'),e("\n  "),a("span",{class:"token punctuation"},"}"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752782-49830"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'import Spider from \'./Spider\'\nimport PhotoListSpider from \'./PhotoListSpider\'\nimport NewsListSpider from \'./NewsListSpider\'\n\nlet spider1: Spider = new PhotoListSpider({\n  url: \'http://web.xx.com/teacher.html\'\n})\n\nlet spider2: Spider = new NewsListSpider({\n  url: \'http://www.xx.cn/news/json/f1f5ccee-1158-49a6-b7c4-f0bf40d5161a.json\',\n  method: \'post\',\n  headers: {\n    "Host": "www.xx.cn",\n    "Connection": "keep-alive",\n    "Content-Length": "0",\n    "Accept": "*/*",\n    "Origin": "http://www.xx.cn",\n    "X-Requested-With": "XMLHttpRequest",\n    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36",\n    "DNT": "1",\n    "Referer": "http://www.xx.cn/newsvideo/newslist.html",\n    "Accept-Encoding": "gzip, deflate",\n    "Accept-Language": "zh-CN,zh;q=0.9,en;q=0.8",\n    "Cookie": "UM_distinctid=16b8a0c1ea534c-0c311b256ffee7-e343166-240000-16b8a0c1ea689c; bad_idb2f10070-624e-11e8-917f-9fb8db4dc43c=8e1dcca1-9692-11e9-97fb-e5908bcaecf8; parent_qimo_sid_b2f10070-624e-11e8-917f-9fb8db4dc43c=921b3900-9692-11e9-9a47-855e632e21e7; CNZZDATA1277769855=1043056636-1562825067-null%7C1562825067; cid_litiancheng_xx.cn=TUd3emFUWjBNV2syWVRCdU5XTTRhREZs; PHPSESSID=j3ppafq1dgh2jfg6roc8eeljg2; CNZZDATA4617777=cnzz_eid%3D926291424-1561388898-http%253A%252F%252Fmail.xx.cn%252F%26ntime%3D1563262791; Hm_lvt_0cb375a2e834821b74efffa6c71ee607=1561389179,1563266246; qimo_seosource_22bdcd10-6250-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_22bdcd10-6250-11e8-917f-9fb8db4dc43c=; href=http%3A%2F%2Fwww.xx.cn%2F; bad_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b71-a7a4-11e9-93cc-9b702389a8cb; nice_id22bdcd10-6250-11e8-917f-9fb8db4dc43c=f2f41b72-a7a4-11e9-93cc-9b702389a8cb; openChat22bdcd10-6250-11e8-917f-9fb8db4dc43c=true; parent_qimo_sid_22bdcd10-6250-11e8-917f-9fb8db4dc43c=fc61e520-a7a4-11e9-94a8-01dabdc2ed41; qimo_seosource_b2f10070-624e-11e8-917f-9fb8db4dc43c=%E7%AB%99%E5%86%85; qimo_seokeywords_b2f10070-624e-11e8-917f-9fb8db4dc43c=; accessId=b2f10070-624e-11e8-917f-9fb8db4dc43c; pageViewNum=2; nice_idb2f10070-624e-11e8-917f-9fb8db4dc43c=20d2a1d1-a7a8-11e9-bc20-e71d1b8e4bb6; openChatb2f10070-624e-11e8-917f-9fb8db4dc43c=true; Hm_lpvt_0cb375a2e834821b74efffa6c71ee607=1563267937"\n  }\n})\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752782-49830","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br")])],-1),z=t('<p>封装后，如果需要写新的爬虫，则可以直接继承Spider类后，在测试类中进行测试即可，仅需实现具体的爬虫类onCatchHTML方法，测试时传入url和headers即可。</p><p>而且全部爬虫的父类均为Spider，后期管理起来也非常方便！</p><h1 id="爬虫高级"><a class="header-anchor" href="#爬虫高级" aria-hidden="true">#</a> 爬虫高级</h1><p>目标：</p><ul><li>使用Selenium库爬取前端渲染的网页</li><li>反反爬虫技术</li></ul><h2 id="selenium简介"><a class="header-anchor" href="#selenium简介" aria-hidden="true">#</a> Selenium简介</h2><p>官方原文介绍：</p><blockquote><p><em>Selenium automates browsers</em>. That&#39;s it! What you do with that power is entirely up to you. Primarily, it is for automating web applications for testing purposes, but is certainly not limited to just that. Boring web-based administration tasks can (and should!) be automated as well.</p><p>Selenium has the support of some of the largest browser vendors who have taken (or are taking) steps to make Selenium a native part of their browser. It is also the core technology in countless other browser automation tools, APIs and frameworks.</p></blockquote><p>百度百科介绍：</p><blockquote><p>Selenium [1] 是一个用于Web应用程序测试的工具。Selenium测试直接运行在浏览器中，就像真正的用户在操作一样。支持的浏览器包括IE（7, 8, 9, 10, 11），[Mozilla Firefox](<a href="https://baike.baidu.com/item/Mozilla" target="_blank" rel="noopener noreferrer">https://baike.baidu.com/item/Mozilla</a> Firefox/3504923)，Safari，Google Chrome，Opera等。这个工具的主要功能包括：测试与浏览器的兼容性——测试你的应用程序看是否能够很好得工作在不同浏览器和操作系统之上。测试系统功能——创建回归测试检验软件功能和用户需求。支持自动录制动作和自动生成 .Net、Java、Perl等不同语言的测试脚本。</p></blockquote><p>简单总结：</p><p>Selenium是一个Web应用的自动化测试框架，可以创建回归测试来检验软件功能和用户需求，通过框架可以编写代码来启动浏览器进行自动化测试，换言之，用于做爬虫就可以使用代码启动浏览器，让真正的浏览器去打开网页，然后去网页中获取想要的信息！从而实现真正意义上无惧反爬虫手段！</p><h2 id="selenium的基本使用"><a class="header-anchor" href="#selenium的基本使用" aria-hidden="true">#</a> Selenium的基本使用</h2><ol><li><p>根据平台下载需要的webdriver</p></li><li><p>项目中安装selenium-webdriver包</p></li><li><p>根据官方文档写一个小demo</p></li></ol><h3 id="根据平台选择webdriver"><a class="header-anchor" href="#根据平台选择webdriver" aria-hidden="true">#</a> 根据平台选择webdriver</h3><table><thead><tr><th style="text-align:left;">浏览器</th><th style="text-align:left;">webdriver</th></tr></thead><tbody><tr><td style="text-align:left;">Chrome</td><td style="text-align:left;"><a href="http://chromedriver.storage.googleapis.com/index.html" target="_blank" rel="noopener noreferrer">chromedriver(.exe)</a></td></tr><tr><td style="text-align:left;">Internet Explorer</td><td style="text-align:left;"><a href="http://selenium-release.storage.googleapis.com/index.html" target="_blank" rel="noopener noreferrer">IEDriverServer.exe</a></td></tr><tr><td style="text-align:left;">Edge</td><td style="text-align:left;"><a href="http://go.microsoft.com/fwlink/?LinkId=619687" target="_blank" rel="noopener noreferrer">MicrosoftWebDriver.msi</a></td></tr><tr><td style="text-align:left;">Firefox</td><td style="text-align:left;"><a href="https://github.com/mozilla/geckodriver/releases/" target="_blank" rel="noopener noreferrer">geckodriver(.exe)</a></td></tr><tr><td style="text-align:left;">Safari</td><td style="text-align:left;"><a href="https://developer.apple.com/library/prerelease/content/releasenotes/General/WhatsNewInSafari/Articles/Safari_10_0.html#//apple_ref/doc/uid/TP40014305-CH11-DontLinkElementID_28" target="_blank" rel="noopener noreferrer">safaridriver</a></td></tr></tbody></table><p>选择版本和平台：</p><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165113.png" alt="1563344131390"></p><p>下载后放入项目根目录</p><h3 id="安装selenium-webdriver的包"><a class="header-anchor" href="#安装selenium-webdriver的包" aria-hidden="true">#</a> 安装selenium-webdriver的包</h3><p><code>npm i selenium-webdriver</code></p><h3 id="自动打开百度搜索前端程序员"><a class="header-anchor" href="#自动打开百度搜索前端程序员" aria-hidden="true">#</a> 自动打开百度搜索“前端程序员“</h3>',22),V=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"const"),e(),a("span",{class:"token punctuation"},"{"),e(" Builder"),a("span",{class:"token punctuation"},","),e(" By"),a("span",{class:"token punctuation"},","),e(" Key"),a("span",{class:"token punctuation"},","),e(" until "),a("span",{class:"token punctuation"},"}"),e(),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'selenium-webdriver'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n\n"),a("span",{class:"token punctuation"},"("),a("span",{class:"token keyword"},"async"),e(),a("span",{class:"token keyword"},"function"),e(),a("span",{class:"token function"},"example"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token keyword"},"let"),e(" driver "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(),a("span",{class:"token keyword"},"new"),e(),a("span",{class:"token class-name"},"Builder"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"forBrowser"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'chrome'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"build"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token comment"},"// try {"),e("\n  "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"get"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'https://www.baidu.com'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"id"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'kw'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"sendKeys"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'前端程序员'"),a("span",{class:"token punctuation"},","),e(" Key"),a("span",{class:"token punctuation"},"."),a("span",{class:"token constant"},"ENTER"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"wait"),a("span",{class:"token punctuation"},"("),e("until"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"titleIs"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'前端程序员_百度搜索'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token number"},"1000"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token comment"},"// } finally {"),e("\n  "),a("span",{class:"token comment"},"//   await driver.quit();"),e("\n  "),a("span",{class:"token comment"},"// }"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752782-14988"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const { Builder, By, Key, until } = require('selenium-webdriver');\n\n(async function example() {\n  let driver = await new Builder().forBrowser('chrome').build();\n  // try {\n  await driver.get('https://www.baidu.com');\n  await driver.findElement(By.id('kw')).sendKeys('前端程序员', Key.ENTER);\n  console.log(await driver.wait(until.titleIs('前端程序员_百度搜索'), 1000))\n  // } finally {\n  //   await driver.quit();\n  // }\n})();\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752782-14988","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br")])],-1),G=t('<h2 id="使用selenium实现爬虫"><a class="header-anchor" href="#使用selenium实现爬虫" aria-hidden="true">#</a> 使用Selenium实现爬虫</h2><p>在使用Selenium实现爬虫之前，需要搞清楚一个问题：</p><ul><li>为什么要用Selenium来做爬虫？</li></ul><p>了解完后，还需要知道，如何实现爬虫？</p><ol><li>自动打开拉勾网并搜索&quot;前端&quot;</li><li>获取所有列表项</li><li>获取其中想要的信息数据</li></ol><h3 id="为什么要用selenium来做爬虫"><a class="header-anchor" href="#为什么要用selenium来做爬虫" aria-hidden="true">#</a> 为什么要用Selenium来做爬虫</h3><p>目前的大流量网站，都会有些对应的反爬虫机制</p><p>例如在拉勾网上搜索前端：</p><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165114.png" alt="1563347543424"></p><p>找到对应的ajax请求地址，使用postman来测试数据：</p><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165538.png" alt=""></p><p>前几次可能会获取到数据，但多几次则会出现操作频繁请稍后再试的问题</p><p>而通过Selenium可以操作浏览器，打开某个网址，接下来只需要学习其API，就能获取网页中需要的内容了！</p><p>反爬虫技术只是针对爬虫的，例如检查请求头是否像爬虫，检查IP地址的请求频率（如果过高则封杀）等手段</p><p>而Selenium打开的就是一个自动化测试的浏览器，和用户正常使用的浏览器并无差别，所以再厉害的反爬虫技术，也无法直接把它干掉，除非这个网站连普通用户都想放弃掉（12306曾经迫于无奈这样做过）</p><h3 id="selenium-api学习"><a class="header-anchor" href="#selenium-api学习" aria-hidden="true">#</a> Selenium API学习</h3><p>核心对象：</p><ul><li><p>Builder</p></li><li><p>WebDriver</p></li><li><p>WebElement</p></li></ul><p>辅助对象：</p><ul><li>By</li><li>Key</li></ul><h4 id="builder"><a class="header-anchor" href="#builder" aria-hidden="true">#</a> Builder</h4><p>用于构建WebDriver对象的构造器</p>',22),Z=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[e(),a("span",{class:"token keyword"},"let"),e(" driver "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"new"),e(),a("span",{class:"token class-name"},[e("webdriver"),a("span",{class:"token punctuation"},"."),e("Builder")]),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n     "),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"forBrowser"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'chrome'"),a("span",{class:"token punctuation"},")"),e("\n     "),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"build"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752782-99706"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":" let driver = new webdriver.Builder()\n     .forBrowser('chrome')\n     .build();\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752782-99706","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br")])],-1),X=a("p",null,"其他API如下：",-1),J=a("p",null,"可以获取或设置一些Options",-1),Q=a("p",null,[a("img",{src:"https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165116.png",alt:"1563349592653"})],-1),Y=a("p",null,"如需设置Chrome的Options，需要先导入Options：",-1),nn=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"const"),e(),a("span",{class:"token punctuation"},"{"),e(" Options "),a("span",{class:"token punctuation"},"}"),e(),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'selenium-webdriver/chrome'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n"),a("span",{class:"token keyword"},"const"),e(" options "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"new"),e(),a("span",{class:"token class-name"},"Options"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\noptions"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"addArguments"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'Cookie=user_trace_token=20191130095945-889e634a-a79b-4b61-9ced-996eca44b107; X_HTTP_TOKEN=7470c50044327b9a2af2946eaad67653; _ga=GA1.2.2111156102.1543543186; _gid=GA1.2.1593040181.1543543186; LGUID=20181130095946-9c90e147-f443-11e8-87e4-525400f775ce; sajssdk_2015_cross_new_user=1; JSESSIONID=ABAAABAAAGGABCB5E0E82B87052ECD8CED0421F1D36020D; index_location_city=%E5%85%A8%E5%9B%BD; Hm_lvt_4233e74dff0ae5bd0a3d81c6ccf756e6=1543543186,1543545866; LGSID=20181130104426-da2fc57f-f449-11e8-87ea-525400f775ce; PRE_UTM=; PRE_HOST=www.cnblogs.com; PRE_SITE=https%3A%2F%2Fwww.cnblogs.com%2F; PRE_LAND=https%3A%2F%2Fwww.lagou.com%2Fjobs%2Flist_%25E5%2589%258D%25E7%25AB%25AF%25E5%25BC%2580%25E5%258F%2591%3Fkd%3D%25E5%2589%258D%25E7%25AB%25AF%25E5%25BC%2580%25E5%258F%2591%26spc%3D1%26pl%3D%26gj%3D%26xl%3D%26yx%3D%26gx%3D%26st%3D%26labelWords%3Dlabel%26lc%3D%26workAddress%3D%26city%3D%25E5%2585%25A8%25E5%259B%25BD%26requestId%3D%26pn%3D1; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%221676257e1bd8cc-060451fc44d124-9393265-2359296-1676257e1be898%22%2C%22%24device_id%22%3A%221676257e1bd8cc-060451fc44d124-9393265-2359296-1676257e1be898%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_referrer%22%3A%22%22%2C%22%24latest_referrer_host%22%3A%22%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%7D%7D; ab_test_random_num=0; _putrc=30FD5A7177A00E45123F89F2B170EADC; login=true; unick=%E5%A4%A9%E6%88%90; hasDeliver=0; gate_login_token=3e9da07186150513b28b29e8e74f485b86439e1fd26fc4939d32ed2660e8421a; _gat=1; SEARCH_ID=334cf2a080f44f2fb42841f473719162; LGRID=20181130110855-45ea2d22-f44d-11e8-87ee-525400f775ce; Hm_lpvt_4233e74dff0ae5bd0a3d81c6ccf756e6=1543547335; TG-TRACK-CODE=search_code'"),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"addArguments"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'user-agent=\"Mozilla/5.0 (iPod; U; CPU iPhone OS 2_1 like Mac OS X; ja-jp) AppleWebKit/525.18.1 (KHTML, like Gecko) Version/3.1.1 Mobile/5F137 Safari/525.20'"),a("span",{class:"token punctuation"},")"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752782-76392"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const { Options } = require('selenium-webdriver/chrome');\nconst options = new Options()\noptions.addArguments('Cookie=user_trace_token=20191130095945-889e634a-a79b-4b61-9ced-996eca44b107; X_HTTP_TOKEN=7470c50044327b9a2af2946eaad67653; _ga=GA1.2.2111156102.1543543186; _gid=GA1.2.1593040181.1543543186; LGUID=20181130095946-9c90e147-f443-11e8-87e4-525400f775ce; sajssdk_2015_cross_new_user=1; JSESSIONID=ABAAABAAAGGABCB5E0E82B87052ECD8CED0421F1D36020D; index_location_city=%E5%85%A8%E5%9B%BD; Hm_lvt_4233e74dff0ae5bd0a3d81c6ccf756e6=1543543186,1543545866; LGSID=20181130104426-da2fc57f-f449-11e8-87ea-525400f775ce; PRE_UTM=; PRE_HOST=www.cnblogs.com; PRE_SITE=https%3A%2F%2Fwww.cnblogs.com%2F; PRE_LAND=https%3A%2F%2Fwww.lagou.com%2Fjobs%2Flist_%25E5%2589%258D%25E7%25AB%25AF%25E5%25BC%2580%25E5%258F%2591%3Fkd%3D%25E5%2589%258D%25E7%25AB%25AF%25E5%25BC%2580%25E5%258F%2591%26spc%3D1%26pl%3D%26gj%3D%26xl%3D%26yx%3D%26gx%3D%26st%3D%26labelWords%3Dlabel%26lc%3D%26workAddress%3D%26city%3D%25E5%2585%25A8%25E5%259B%25BD%26requestId%3D%26pn%3D1; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%221676257e1bd8cc-060451fc44d124-9393265-2359296-1676257e1be898%22%2C%22%24device_id%22%3A%221676257e1bd8cc-060451fc44d124-9393265-2359296-1676257e1be898%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_referrer%22%3A%22%22%2C%22%24latest_referrer_host%22%3A%22%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%7D%7D; ab_test_random_num=0; _putrc=30FD5A7177A00E45123F89F2B170EADC; login=true; unick=%E5%A4%A9%E6%88%90; hasDeliver=0; gate_login_token=3e9da07186150513b28b29e8e74f485b86439e1fd26fc4939d32ed2660e8421a; _gat=1; SEARCH_ID=334cf2a080f44f2fb42841f473719162; LGRID=20181130110855-45ea2d22-f44d-11e8-87ee-525400f775ce; Hm_lpvt_4233e74dff0ae5bd0a3d81c6ccf756e6=1543547335; TG-TRACK-CODE=search_code')\n    .addArguments('user-agent=\"Mozilla/5.0 (iPod; U; CPU iPhone OS 2_1 like Mac OS X; ja-jp) AppleWebKit/525.18.1 (KHTML, like Gecko) Version/3.1.1 Mobile/5F137 Safari/525.20')\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752782-76392","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br")])],-1),sn=t('<h4 id="webdriver"><a class="header-anchor" href="#webdriver" aria-hidden="true">#</a> WebDriver</h4><p>通过构造器创建好WebDriver后就可以使用API查找网页元素和获取信息了：</p><ul><li>findElement() 查找元素</li></ul><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165117.png" alt="1563349913348"></p><h4 id="webelement"><a class="header-anchor" href="#webelement" aria-hidden="true">#</a> WebElement</h4><ul><li>getText() 获取文本内容</li><li>sendKeys() 发送一些按键指令</li><li>click() 点击该元素</li></ul><p><img src="https://gitee.com/artiely/Figure-bed/raw/master/images/20200314165118.png" alt="1563351143458"></p><h3 id="自动打开拉勾网搜索前端"><a class="header-anchor" href="#自动打开拉勾网搜索前端" aria-hidden="true">#</a> 自动打开拉勾网搜索&quot;前端&quot;</h3><ol><li><p>使用driver打开拉勾网主页</p></li><li><p>找到全国站并点击一下</p></li><li><p>输入“前端”并回车</p></li></ol>',9),tn=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"const"),e(),a("span",{class:"token punctuation"},"{"),e(" Builder"),a("span",{class:"token punctuation"},","),e(" By"),a("span",{class:"token punctuation"},","),e(" Key "),a("span",{class:"token punctuation"},"}"),e(),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'selenium-webdriver'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n\n"),a("span",{class:"token punctuation"},"("),a("span",{class:"token keyword"},"async"),e(),a("span",{class:"token keyword"},"function"),e(),a("span",{class:"token function"},"start"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token keyword"},"let"),e(" driver "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(),a("span",{class:"token keyword"},"new"),e(),a("span",{class:"token class-name"},"Builder"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"forBrowser"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'chrome'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"build"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"get"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'https://www.lagou.com/'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'#changeCityBox .checkTips .tab.focus'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"click"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"id"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'search_input'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"sendKeys"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'前端'"),a("span",{class:"token punctuation"},","),e(" Key"),a("span",{class:"token punctuation"},"."),a("span",{class:"token constant"},"ENTER"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752783-54177"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const { Builder, By, Key } = require('selenium-webdriver');\n\n(async function start() {\n  let driver = await new Builder().forBrowser('chrome').build();\n  await driver.get('https://www.lagou.com/');\n  await driver.findElement(By.css('#changeCityBox .checkTips .tab.focus')).click();\n  await driver.findElement(By.id('search_input')).sendKeys('前端', Key.ENTER);\n})();\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752783-54177","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br")])],-1),an=a("h3",{id:"获取需要的数据"},[a("a",{class:"header-anchor",href:"#获取需要的数据","aria-hidden":"true"},"#"),e(" 获取需要的数据")],-1),en=a("p",null,"使用driver.findElement()找到所有条目项，根据需求分析页面元素，获取其文本内容即可：",-1),cn=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"const"),e(),a("span",{class:"token punctuation"},"{"),e(" Builder"),a("span",{class:"token punctuation"},","),e(" By"),a("span",{class:"token punctuation"},","),e(" Key "),a("span",{class:"token punctuation"},"}"),e(),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'selenium-webdriver'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n\n"),a("span",{class:"token punctuation"},"("),a("span",{class:"token keyword"},"async"),e(),a("span",{class:"token keyword"},"function"),e(),a("span",{class:"token function"},"start"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token keyword"},"let"),e(" driver "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(),a("span",{class:"token keyword"},"new"),e(),a("span",{class:"token class-name"},"Builder"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"forBrowser"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'chrome'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"build"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"get"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'https://www.lagou.com/'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'#changeCityBox .checkTips .tab.focus'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"click"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"id"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'search_input'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"sendKeys"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'前端'"),a("span",{class:"token punctuation"},","),e(" Key"),a("span",{class:"token punctuation"},"."),a("span",{class:"token constant"},"ENTER"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token keyword"},"let"),e(" items "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElements"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"className"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'con_list_item'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n  items"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"forEach"),a("span",{class:"token punctuation"},"("),a("span",{class:"token keyword"},"async"),e(),a("span",{class:"token parameter"},"item"),e(),a("span",{class:"token operator"},"=>"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token comment"},"// 获取岗位名称"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" title "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.p_top h3'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token comment"},"// 获取工作地点"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" position "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.p_top em'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token comment"},"// 获取发布时间"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" time "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.p_top .format-time'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token comment"},"// 获取公司名称"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" companyName "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.company .company_name'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token comment"},"// 获取公司所在行业"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" industry "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.company .industry'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token comment"},"// 获取薪资待遇"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" money "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.p_bot .money'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token comment"},"// 获取需求背景"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" background "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.p_bot .li_b_l'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n    "),a("span",{class:"token comment"},"// 处理需求背景"),e("\n    background "),a("span",{class:"token operator"},"="),e(" background"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"replace"),a("span",{class:"token punctuation"},"("),e("money"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token string"},"''"),a("span",{class:"token punctuation"},")"),e("\n    console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),e("title"),a("span",{class:"token punctuation"},","),e(" position"),a("span",{class:"token punctuation"},","),e(" time"),a("span",{class:"token punctuation"},","),e(" companyName"),a("span",{class:"token punctuation"},","),e(" industry"),a("span",{class:"token punctuation"},","),e(" money"),a("span",{class:"token punctuation"},","),e(" background"),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752783-51442"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const { Builder, By, Key } = require('selenium-webdriver');\n\n(async function start() {\n  let driver = await new Builder().forBrowser('chrome').build();\n  await driver.get('https://www.lagou.com/');\n  await driver.findElement(By.css('#changeCityBox .checkTips .tab.focus')).click();\n  await driver.findElement(By.id('search_input')).sendKeys('前端', Key.ENTER);\n  let items = await driver.findElements(By.className('con_list_item'))\n  items.forEach(async item => {\n    // 获取岗位名称\n    let title = await item.findElement(By.css('.p_top h3')).getText()\n    // 获取工作地点\n    let position = await item.findElement(By.css('.p_top em')).getText()\n    // 获取发布时间\n    let time = await item.findElement(By.css('.p_top .format-time')).getText()\n    // 获取公司名称\n    let companyName = await item.findElement(By.css('.company .company_name')).getText()\n    // 获取公司所在行业\n    let industry = await item.findElement(By.css('.company .industry')).getText()\n    // 获取薪资待遇\n    let money = await item.findElement(By.css('.p_bot .money')).getText()\n    // 获取需求背景\n    let background = await item.findElement(By.css('.p_bot .li_b_l')).getText()\n    // 处理需求背景\n    background = background.replace(money, '')\n    console.log(title, position, time, companyName, industry, money, background)\n  })\n})();\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752783-51442","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br"),a("span",{class:"line-number"},"27"),a("br"),a("span",{class:"line-number"},"28"),a("br")])],-1),on=a("h3",{id:"自动翻页"},[a("a",{class:"header-anchor",href:"#自动翻页","aria-hidden":"true"},"#"),e(" 自动翻页")],-1),pn=a("p",null,"思路如下：",-1),ln=a("ol",null,[a("li",null,"定义初始页码"),a("li",null,"获取数据后，获取页面上的总页码，定义最大页码"),a("li",null,"开始获取数据时打印当前正在获取的页码数"),a("li",null,"获取完一页数据后，当前页码自增，然后判断是否达到最大页码"),a("li",null,"查找下一页按钮并调用点击api，进行自动翻页"),a("li",null,"翻页后递归调用获取数据的函数")],-1),un=a("div",{class:"language-js line-numbers-mode"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"const"),e(),a("span",{class:"token punctuation"},"{"),e(" Builder"),a("span",{class:"token punctuation"},","),e(" By"),a("span",{class:"token punctuation"},","),e(" Key "),a("span",{class:"token punctuation"},"}"),e(),a("span",{class:"token operator"},"="),e(),a("span",{class:"token function"},"require"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'selenium-webdriver'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n\n"),a("span",{class:"token keyword"},"let"),e(" currentPageNum "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token number"},"1"),a("span",{class:"token punctuation"},";"),e("\n"),a("span",{class:"token keyword"},"let"),e(" maxPageNum "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token number"},"1"),a("span",{class:"token punctuation"},";"),e("\n"),a("span",{class:"token keyword"},"let"),e(" driver "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"new"),e(),a("span",{class:"token class-name"},"Builder"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"forBrowser"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'chrome'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"build"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n\n"),a("span",{class:"token punctuation"},"("),a("span",{class:"token keyword"},"async"),e(),a("span",{class:"token keyword"},"function"),e(),a("span",{class:"token function"},"start"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n  "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"get"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'https://www.lagou.com/'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'#changeCityBox .checkTips .tab.focus'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"click"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"id"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'search_input'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"sendKeys"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'前端'"),a("span",{class:"token punctuation"},","),e(" Key"),a("span",{class:"token punctuation"},"."),a("span",{class:"token constant"},"ENTER"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n  maxPageNum "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"className"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'totalNum'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token function"},"getData"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),e("\n\n"),a("span",{class:"token keyword"},"async"),e(),a("span",{class:"token keyword"},"function"),e(),a("span",{class:"token function"},"getData"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n  console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),a("span",{class:"token template-string"},[a("span",{class:"token template-punctuation string"},"`"),a("span",{class:"token string"},"正在获取第"),a("span",{class:"token interpolation"},[a("span",{class:"token interpolation-punctuation punctuation"},"${"),e("currentPageNum"),a("span",{class:"token interpolation-punctuation punctuation"},"}")]),a("span",{class:"token string"},"页的数据, 共"),a("span",{class:"token interpolation"},[a("span",{class:"token interpolation-punctuation punctuation"},"${"),e("maxPageNum"),a("span",{class:"token interpolation-punctuation punctuation"},"}")]),a("span",{class:"token string"},"页"),a("span",{class:"token template-punctuation string"},"`")]),a("span",{class:"token punctuation"},")"),e("\n  "),a("span",{class:"token keyword"},"while"),e(),a("span",{class:"token punctuation"},"("),a("span",{class:"token boolean"},"true"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n    "),a("span",{class:"token keyword"},"let"),e(" flag "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token boolean"},"true"),e("\n    "),a("span",{class:"token keyword"},"try"),e(),a("span",{class:"token punctuation"},"{"),e("\n      "),a("span",{class:"token keyword"},"let"),e(" items "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElements"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"className"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'con_list_item'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),e("\n      "),a("span",{class:"token keyword"},"let"),e(" results "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token punctuation"},"["),a("span",{class:"token punctuation"},"]"),e("\n      "),a("span",{class:"token keyword"},"for"),e(),a("span",{class:"token punctuation"},"("),a("span",{class:"token keyword"},"let"),e(" i "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token number"},"0"),a("span",{class:"token punctuation"},";"),e(" i "),a("span",{class:"token operator"},"<"),e(" items"),a("span",{class:"token punctuation"},"."),e("length"),a("span",{class:"token punctuation"},";"),e(" i"),a("span",{class:"token operator"},"++"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n        "),a("span",{class:"token keyword"},"let"),e(" item "),a("span",{class:"token operator"},"="),e(" items"),a("span",{class:"token punctuation"},"["),e("i"),a("span",{class:"token punctuation"},"]"),e("\n        "),a("span",{class:"token comment"},"// 获取岗位名称"),e("\n        "),a("span",{class:"token keyword"},"let"),e(" title "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.p_top h3'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n        "),a("span",{class:"token comment"},"// 获取工作地点"),e("\n        "),a("span",{class:"token keyword"},"let"),e(" position "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.p_top em'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n        "),a("span",{class:"token comment"},"// 获取发布时间"),e("\n        "),a("span",{class:"token keyword"},"let"),e(" time "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.p_top .format-time'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n        "),a("span",{class:"token comment"},"// 获取公司名称"),e("\n        "),a("span",{class:"token keyword"},"let"),e(" companyName "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.company .company_name'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n        "),a("span",{class:"token comment"},"// 获取公司所在行业"),e("\n        "),a("span",{class:"token keyword"},"let"),e(" industry "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.company .industry'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n        "),a("span",{class:"token comment"},"// 获取薪资待遇"),e("\n        "),a("span",{class:"token keyword"},"let"),e(" money "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.p_bot .money'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n        "),a("span",{class:"token comment"},"// 获取需求背景"),e("\n        "),a("span",{class:"token keyword"},"let"),e(" background "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token keyword"},"await"),e(" item"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"css"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'.p_bot .li_b_l'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"getText"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n        "),a("span",{class:"token comment"},"// 处理需求背景"),e("\n        background "),a("span",{class:"token operator"},"="),e(" background"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"replace"),a("span",{class:"token punctuation"},"("),e("money"),a("span",{class:"token punctuation"},","),e(),a("span",{class:"token string"},"''"),a("span",{class:"token punctuation"},")"),e("\n        "),a("span",{class:"token comment"},"// console.log(id, job, area, money, link, need, companyLink, industry, tags, welfare)"),e("\n        results"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"push"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),e("\n          title"),a("span",{class:"token punctuation"},","),e("\n          position"),a("span",{class:"token punctuation"},","),e("\n          time"),a("span",{class:"token punctuation"},","),e("\n          companyName"),a("span",{class:"token punctuation"},","),e("\n          industry"),a("span",{class:"token punctuation"},","),e("\n          money"),a("span",{class:"token punctuation"},","),e("\n          background\n        "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),e("\n      "),a("span",{class:"token punctuation"},"}"),e("\n\n      console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),e("results"),a("span",{class:"token punctuation"},")"),e("\n\n      currentPageNum"),a("span",{class:"token operator"},"++"),e("\n      "),a("span",{class:"token keyword"},"if"),e(),a("span",{class:"token punctuation"},"("),e("currentPageNum "),a("span",{class:"token operator"},"<="),e(" maxPageNum"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n        "),a("span",{class:"token keyword"},"await"),e(" driver"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"findElement"),a("span",{class:"token punctuation"},"("),e("By"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"className"),a("span",{class:"token punctuation"},"("),a("span",{class:"token string"},"'pager_next'"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"click"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),e("\n        "),a("span",{class:"token keyword"},"await"),e(),a("span",{class:"token function"},"getData"),a("span",{class:"token punctuation"},"("),e("driver"),a("span",{class:"token punctuation"},")"),e("\n      "),a("span",{class:"token punctuation"},"}"),e("\n    "),a("span",{class:"token punctuation"},"}"),e(),a("span",{class:"token keyword"},"catch"),e(),a("span",{class:"token punctuation"},"("),e("e"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token punctuation"},"{"),e("\n      "),a("span",{class:"token comment"},"// console.log(e.message)"),e("\n      "),a("span",{class:"token keyword"},"if"),e(),a("span",{class:"token punctuation"},"("),e("e"),a("span",{class:"token punctuation"},")"),e(" flag "),a("span",{class:"token operator"},"="),e(),a("span",{class:"token boolean"},"false"),e("\n    "),a("span",{class:"token punctuation"},"}"),e(),a("span",{class:"token keyword"},"finally"),e(),a("span",{class:"token punctuation"},"{"),e("\n      "),a("span",{class:"token keyword"},"if"),e(),a("span",{class:"token punctuation"},"("),e("flag"),a("span",{class:"token punctuation"},")"),e(),a("span",{class:"token keyword"},"break"),e("\n    "),a("span",{class:"token punctuation"},"}"),e("\n  "),a("span",{class:"token punctuation"},"}"),e("\n"),a("span",{class:"token punctuation"},"}"),e("\n")]),a("div",{class:"m-mdic-copy-wrapper"},[a("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558752783-1670"},"复制成功"),a("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const { Builder, By, Key } = require('selenium-webdriver');\n\nlet currentPageNum = 1;\nlet maxPageNum = 1;\nlet driver = new Builder().forBrowser('chrome').build();\n\n(async function start() {\n  await driver.get('https://www.lagou.com/');\n  await driver.findElement(By.css('#changeCityBox .checkTips .tab.focus')).click();\n  await driver.findElement(By.id('search_input')).sendKeys('前端', Key.ENTER);\n  maxPageNum = await driver.findElement(By.className('totalNum')).getText()\n  getData()\n})();\n\nasync function getData() {\n  console.log(`正在获取第${currentPageNum}页的数据, 共${maxPageNum}页`)\n  while (true) {\n    let flag = true\n    try {\n      let items = await driver.findElements(By.className('con_list_item'))\n      let results = []\n      for (let i = 0; i < items.length; i++) {\n        let item = items[i]\n        // 获取岗位名称\n        let title = await item.findElement(By.css('.p_top h3')).getText()\n        // 获取工作地点\n        let position = await item.findElement(By.css('.p_top em')).getText()\n        // 获取发布时间\n        let time = await item.findElement(By.css('.p_top .format-time')).getText()\n        // 获取公司名称\n        let companyName = await item.findElement(By.css('.company .company_name')).getText()\n        // 获取公司所在行业\n        let industry = await item.findElement(By.css('.company .industry')).getText()\n        // 获取薪资待遇\n        let money = await item.findElement(By.css('.p_bot .money')).getText()\n        // 获取需求背景\n        let background = await item.findElement(By.css('.p_bot .li_b_l')).getText()\n        // 处理需求背景\n        background = background.replace(money, '')\n        // console.log(id, job, area, money, link, need, companyLink, industry, tags, welfare)\n        results.push({\n          title,\n          position,\n          time,\n          companyName,\n          industry,\n          money,\n          background\n        })\n      }\n\n      console.log(results)\n\n      currentPageNum++\n      if (currentPageNum <= maxPageNum) {\n        await driver.findElement(By.className('pager_next')).click()\n        await getData(driver)\n      }\n    } catch (e) {\n      // console.log(e.message)\n      if (e) flag = false\n    } finally {\n      if (flag) break\n    }\n  }\n}\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558752783-1670","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),a("div",{class:"line-numbers-wrapper"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br"),a("span",{class:"line-number"},"27"),a("br"),a("span",{class:"line-number"},"28"),a("br"),a("span",{class:"line-number"},"29"),a("br"),a("span",{class:"line-number"},"30"),a("br"),a("span",{class:"line-number"},"31"),a("br"),a("span",{class:"line-number"},"32"),a("br"),a("span",{class:"line-number"},"33"),a("br"),a("span",{class:"line-number"},"34"),a("br"),a("span",{class:"line-number"},"35"),a("br"),a("span",{class:"line-number"},"36"),a("br"),a("span",{class:"line-number"},"37"),a("br"),a("span",{class:"line-number"},"38"),a("br"),a("span",{class:"line-number"},"39"),a("br"),a("span",{class:"line-number"},"40"),a("br"),a("span",{class:"line-number"},"41"),a("br"),a("span",{class:"line-number"},"42"),a("br"),a("span",{class:"line-number"},"43"),a("br"),a("span",{class:"line-number"},"44"),a("br"),a("span",{class:"line-number"},"45"),a("br"),a("span",{class:"line-number"},"46"),a("br"),a("span",{class:"line-number"},"47"),a("br"),a("span",{class:"line-number"},"48"),a("br"),a("span",{class:"line-number"},"49"),a("br"),a("span",{class:"line-number"},"50"),a("br"),a("span",{class:"line-number"},"51"),a("br"),a("span",{class:"line-number"},"52"),a("br"),a("span",{class:"line-number"},"53"),a("br"),a("span",{class:"line-number"},"54"),a("br"),a("span",{class:"line-number"},"55"),a("br"),a("span",{class:"line-number"},"56"),a("br"),a("span",{class:"line-number"},"57"),a("br"),a("span",{class:"line-number"},"58"),a("br"),a("span",{class:"line-number"},"59"),a("br"),a("span",{class:"line-number"},"60"),a("br"),a("span",{class:"line-number"},"61"),a("br"),a("span",{class:"line-number"},"62"),a("br"),a("span",{class:"line-number"},"63"),a("br"),a("span",{class:"line-number"},"64"),a("br"),a("span",{class:"line-number"},"65"),a("br"),a("span",{class:"line-number"},"66"),a("br")])],-1),rn=t('<h1 id="selenium的取代puppeteer"><a class="header-anchor" href="#selenium的取代puppeteer" aria-hidden="true">#</a> Selenium的取代<a href="https://github.com/puppeteer/puppeteer" target="_blank" rel="noopener noreferrer"><em>puppeteer</em></a></h1><h1 id="总结"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h1><p>爬虫神通广大，用途非常广泛，主要的目标是为了实现自动化程序，解放程序员的双手</p><p>帮助程序员自动获取一些数据，测试一些软件，甚至自动操作浏览器做很多事情</p><p>也不乏有些不法分子拿爬虫做一些违法的事情，在此希望大家学会爬虫使用在正道上，获取一些我们需要的数据来进行分析</p><p>同时，在爬取目标网站之前，建议大家浏览该网站的robots.txt，来确保自己爬取的数据在对方允许范围之内</p><p>内容涵盖：</p><ol><li>爬虫简介</li><li>爬虫的意义 <ul><li>各行各业的爬虫</li></ul></li><li>使用http模块爬取数据 <ul><li>http模块发送请求</li></ul></li><li>使用cheerio库进行DOM解析 <ul><li>一个服务端解析HTML的库，与jQuery API设计相同</li></ul></li><li>使用download库进行文件下载</li><li>使用TypeScript面向对象思想进行爬虫基础库的封装</li><li>使用Selenium实现爬虫</li><li>使用Selenium自动翻页</li><li>Selenium的取代<a href="https://github.com/puppeteer/puppeteer" target="_blank" rel="noopener noreferrer"><em>puppeteer</em></a></li></ol><p>学习不是百米冲刺，而是一场马拉松，现在所学只是起点，更多的是需要大家找到学习方法，不断的学习提升自己，一起加油！</p>',9);o.render=function(t,a,e,c,o,kn){return n(),s("div",null,[p,l,i,u,r,k,d,m,b,y,f,h,g,w,_,C,v,x,E,T,A,B,S,D,N,q,j,F,P,I,$,L,H,R,M,O,K,W,U,z,V,G,Z,X,J,Q,Y,nn,sn,tn,an,en,cn,on,pn,ln,un,rn])};export default o;export{c as __pageData};
