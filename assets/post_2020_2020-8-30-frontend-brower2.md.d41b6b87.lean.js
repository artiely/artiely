import{o as e,c as t,f as n,a as c,x as o}from"./app.b304d650.js";const a='{"title":"前端面试题汇总-浏览器篇-2","description":"","frontmatter":{"title":"前端面试题汇总-浏览器篇-2","tag":["javaScript"],"cover":"https://gitee.com/artiely/Figure-bed/raw/master/image/20200831112934.png","base64":"2b4dd7","author":"artiely","date":"2020-8-30"},"headers":[{"level":2,"title":"Token - 服务端身份验证的流行方案","slug":"token-服务端身份验证的流行方案"},{"level":3,"title":"简述：","slug":"简述"},{"level":2,"title":"身份认证","slug":"身份认证"},{"level":2,"title":"Token机制","slug":"token机制"},{"level":3,"title":"用户匹配","slug":"用户匹配"},{"level":3,"title":"防伪造","slug":"防伪造"},{"level":3,"title":"防冒充","slug":"防冒充"},{"level":2,"title":"Token工作流程","slug":"token工作流程"},{"level":3,"title":"生成token","slug":"生成token"},{"level":3,"title":"拦截验证","slug":"拦截验证"},{"level":3,"title":"token刷新","slug":"token刷新-1"},{"level":2,"title":"基于 Token 的身份验证：JSON Web Token","slug":"基于-token-的身份验证json-web-token"},{"level":3,"title":"传统身份验证的方法","slug":"传统身份验证的方法"},{"level":3,"title":"基于 Token 的身份验证方法","slug":"基于-token-的身份验证方法"},{"level":3,"title":"JWT","slug":"jwt"},{"level":3,"title":"Header","slug":"header"},{"level":3,"title":"Payload","slug":"payload"},{"level":3,"title":"Signature","slug":"signature"},{"level":2,"title":"签发与验证 JWT","slug":"签发与验证-jwt"},{"level":3,"title":"准备项目","slug":"准备项目"},{"level":3,"title":"签发 JWT","slug":"签发-jwt"},{"level":3,"title":"验证 JWT","slug":"验证-jwt"},{"level":3,"title":"RS256 算法","slug":"rs256-算法"},{"level":3,"title":"签发 JWT（RS256 算法）","slug":"签发-jwtrs256-算法"}],"relativePath":"post/2020/2020-8-30-frontend-brower2.md","lastUpdated":1629110864245}',i={},d=n('',62),l=c("div",{class:"language-"},[c("pre",null,[c("code",null,"eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJuaW5naGFvLm5ldCIsImV4cCI6IjE0Mzg5NTU0NDUiLCJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlfQ.SwyHTEx_RQppr97g4J5lKXtabJecpejuef8AqKYMAJc\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-30038"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJuaW5naGFvLm5ldCIsImV4cCI6IjE0Mzg5NTU0NDUiLCJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlfQ.SwyHTEx_RQppr97g4J5lKXtabJecpejuef8AqKYMAJc\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-30038","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),s=c("h3",{id:"header"},[c("a",{class:"header-anchor",href:"#header","aria-hidden":"true"},"#"),o(" Header")],-1),m=c("p",null,"每个 JWT token 里面都有一个 header，也就是头部数据。里面包含了使用的算法，这个 JWT 是不是带签名的或者加密的。主要就是说明一下怎么处理这个 JWT token 。",-1),r=c("p",null,[o("头部里包含的东西可能会根据 JWT 的类型有所变化，比如一个加密的 JWT 里面要包含使用的加密的算法。唯一在头部里面要包含的是 "),c("em",null,"alg"),o(" 这个属性，如果是加密的 JWT，这个属性的值就是使用的签名或者解密用的算法。如果是未加密的 JWT，这个属性的值要设置成 "),c("em",null,"none"),o("。")],-1),p=c("p",null,"示例：",-1),y=c("div",{class:"language-"},[c("pre",null,[c("code",null,'{\n  "alg": "HS256"\n}\n'),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-58153"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'{\n  "alg": "HS256"\n}\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-58153","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br")])],-1),u=c("p",null,[o("意思是这个 JWT 用的算法是 HS256。上面的内容得用 "),c("a",{href:"https://tools.ietf.org/html/rfc4648#section-5",target:"_blank",rel:"noopener noreferrer"},"base64url"),o(" 的形式编码一下，所以就变成这样：")],-1),b=c("div",{class:"language-"},[c("pre",null,[c("code",null,"eyJhbGciOiJIUzI1NiJ9\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-32649"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"eyJhbGciOiJIUzI1NiJ9\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-32649","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),h=n('',4),k=c("div",{class:"language-"},[c("pre",null,[c("code",null,'{\n "iss": "ninghao.net",\n "exp": "1438955445",\n "name": "wanghao",\n "admin": true\n}\n'),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-8880"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'{\n "iss": "ninghao.net",\n "exp": "1438955445",\n "name": "wanghao",\n "admin": true\n}\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-8880","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br")])],-1),f=c("p",null,"使用 base64url 编码以后就变成了这个样子：",-1),C=c("div",{class:"language-"},[c("pre",null,[c("code",null,"eyJpc3MiOiJuaW5naGFvLm5ldCIsImV4cCI6IjE0Mzg5NTU0NDUiLCJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlfQ\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-75302"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"eyJpc3MiOiJuaW5naGFvLm5ldCIsImV4cCI6IjE0Mzg5NTU0NDUiLCJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlfQ\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-75302","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),g=c("h3",{id:"signature"},[c("a",{class:"header-anchor",href:"#signature","aria-hidden":"true"},"#"),o(" Signature")],-1),v=c("p",null,"JWT 的最后一部分是 Signature ，这部分内容有三个部分，先是用 Base64 编码的 header.payload ，再用加密算法加密一下，加密的时候要放进去一个 Secret ，这个相当于是一个密码，这个密码秘密地存储在服务端。",-1),I=c("ul",null,[c("li",null,"header"),c("li",null,"payload"),c("li",null,"secret")],-1),T=c("div",{class:"language-"},[c("pre",null,[c("code",null,"const encodedString = base64UrlEncode(header) + \".\" + base64UrlEncode(payload); \nHMACSHA256(encodedString, 'secret');\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-52507"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const encodedString = base64UrlEncode(header) + \".\" + base64UrlEncode(payload); \nHMACSHA256(encodedString, 'secret');\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-52507","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br")])],-1),j=c("p",null,"处理完成以后看起来像这样：",-1),w=c("div",{class:"language-"},[c("pre",null,[c("code",null,"SwyHTEx_RQppr97g4J5lKXtabJecpejuef8AqKYMAJc\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-40559"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"SwyHTEx_RQppr97g4J5lKXtabJecpejuef8AqKYMAJc\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-40559","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),J=c("p",null,"最后这个在服务端生成并且要发送给客户端的 Token 看起来像这样：",-1),x=c("div",{class:"language-"},[c("pre",null,[c("code",null,"eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJuaW5naGFvLm5ldCIsImV4cCI6IjE0Mzg5NTU0NDUiLCJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlfQ.SwyHTEx_RQppr97g4J5lKXtabJecpejuef8AqKYMAJc\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-67237"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJuaW5naGFvLm5ldCIsImV4cCI6IjE0Mzg5NTU0NDUiLCJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlfQ.SwyHTEx_RQppr97g4J5lKXtabJecpejuef8AqKYMAJc\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-67237","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),N=c("p",null,"客户端收到这个 Token 以后把它存储下来，下回向服务端发送请求的时候就带着这个 Token 。服务端收到这个 Token ，然后进行验证，通过以后就会返回给客户端想要的资源。",-1),E=c("h2",{id:"签发与验证-jwt"},[c("a",{class:"header-anchor",href:"#签发与验证-jwt","aria-hidden":"true"},"#"),o(" 签发与验证 JWT")],-1),W=c("p",null,"在应用里实施使用基于 JWT 这种 Token 的身份验证方法，你可以先去找一个签发与验证 JWT 的功能包。无论你的后端应用使用的是什么样的程序语言，系统，或者框架，你应该都可以找到提供类似功能的包。",-1),$=c("p",null,"下面我们在一个 Node.js 项目里，用最简单的方式来演示一下签发还有验证 JWT 的方法。",-1),A=c("h3",{id:"准备项目"},[c("a",{class:"header-anchor",href:"#准备项目","aria-hidden":"true"},"#"),o(" 准备项目")],-1),F=c("p",null,"准备一个简单的 Node.js 项目：",-1),M=c("div",{class:"language-"},[c("pre",null,[c("code",null,"cd ~/desktop\nmkdir jwt-demo\ncd jwt-demo\nnpm init -y\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-28193"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"cd ~/desktop\nmkdir jwt-demo\ncd jwt-demo\nnpm init -y\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-28193","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br")])],-1),S=c("p",null,[o("安装签发与验证 JWT 的功能包，我用的叫 "),c("a",{href:"https://github.com/auth0/node-jsonwebtoken",target:"_blank",rel:"noopener noreferrer"},[c("em",null,"jsonwebtoken")]),o("，在项目里安装一下这个包：")],-1),U=c("div",{class:"language-"},[c("pre",null,[c("code",null,"npm install jsonwebtoken --save\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-1439"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"npm install jsonwebtoken --save\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-1439","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),_=c("h3",{id:"签发-jwt"},[c("a",{class:"header-anchor",href:"#签发-jwt","aria-hidden":"true"},"#"),o(" 签发 JWT")],-1),D=c("p",null,[o("在项目里随便添加一个 .js 文件，比如 "),c("em",null,"index.js"),o("，在文件里添加下面这些代码：")],-1),P=c("div",{class:"language-"},[c("pre",null,[c("code",null,"const jwt = require('jsonwebtoken')\n\n// Token 数据\nconst payload = {\n  name: 'wanghao',\n  admin: true\n}\n\n// 密钥\nconst secret = 'ILOVENINGHAO'\n\n// 签发 Token\nconst token = jwt.sign(payload, secret, { expiresIn: '1day' })\n\n// 输出签发的 Token\nconsole.log(token)\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-44043"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const jwt = require('jsonwebtoken')\n\n// Token 数据\nconst payload = {\n  name: 'wanghao',\n  admin: true\n}\n\n// 密钥\nconst secret = 'ILOVENINGHAO'\n\n// 签发 Token\nconst token = jwt.sign(payload, secret, { expiresIn: '1day' })\n\n// 输出签发的 Token\nconsole.log(token)\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-44043","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br"),c("span",{class:"line-number"},"9"),c("br"),c("span",{class:"line-number"},"10"),c("br"),c("span",{class:"line-number"},"11"),c("br"),c("span",{class:"line-number"},"12"),c("br"),c("span",{class:"line-number"},"13"),c("br"),c("span",{class:"line-number"},"14"),c("br"),c("span",{class:"line-number"},"15"),c("br"),c("span",{class:"line-number"},"16"),c("br")])],-1),V=n("",3),O=c("div",{class:"language-"},[c("pre",null,[c("code",null,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlLCJpYXQiOjE1MjkwMzM5MDYsImV4cCI6MTUyOTEyMDMwNn0.DctA2QlUCrM6wLWkIO78wBVN0NLpjoIq4T5B_2WJ-PU\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-16793"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlLCJpYXQiOjE1MjkwMzM5MDYsImV4cCI6MTUyOTEyMDMwNn0.DctA2QlUCrM6wLWkIO78wBVN0NLpjoIq4T5B_2WJ-PU\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-16793","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),B=c("p",null,"上面的 Token 内容并没有加密，所以如果用一些 JWT 解码功能，可以看到 Token 里面包含的内容，内容由三个部分组成，像这样：",-1),z=c("div",{class:"language-"},[c("pre",null,[c("code",null,'// header\n{\n  "alg": "HS256", \n  "typ": "JWT"\n}\n\n// payload\n{\n  "admin": true, \n  "iat": 1529033906, \n  "name": "wanghao", \n  "exp": 1529120306\n}\n\n// signature\nDctA2QlUCrM6wLWkIO78wBVN0NLpjoIq4T5B_2WJ-PU\n'),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-29001"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":'// header\n{\n  "alg": "HS256", \n  "typ": "JWT"\n}\n\n// payload\n{\n  "admin": true, \n  "iat": 1529033906, \n  "name": "wanghao", \n  "exp": 1529120306\n}\n\n// signature\nDctA2QlUCrM6wLWkIO78wBVN0NLpjoIq4T5B_2WJ-PU\n',"data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-29001","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br"),c("span",{class:"line-number"},"9"),c("br"),c("span",{class:"line-number"},"10"),c("br"),c("span",{class:"line-number"},"11"),c("br"),c("span",{class:"line-number"},"12"),c("br"),c("span",{class:"line-number"},"13"),c("br"),c("span",{class:"line-number"},"14"),c("br"),c("span",{class:"line-number"},"15"),c("br"),c("span",{class:"line-number"},"16"),c("br")])],-1),L=c("p",null,"假设用户通过了某种身份验证，你就可以使用上面的签发 Token 的功能为用户签发一个 Token。一般在客户端那里会把它保存在 Cookie 或 LocalStorage 里面。",-1),R=c("p",null,"用户下次向我们的应用请求受保护的资源的时候，可以在请求里带着我们给它签发的这个 Token，后端应用收到请求，检查签名，如果验证通过确定这个 Token 是我们自己签发的，那就可以为用户响应回他需要的资源。",-1),Y=c("h3",{id:"验证-jwt"},[c("a",{class:"header-anchor",href:"#验证-jwt","aria-hidden":"true"},"#"),o(" 验证 JWT")],-1),G=c("p",null,[o("验证 JWT 的用效性，确定一下用户的 JWT 是我们自己签发的，首先要得到用户的这个 JWT Token，然后用 "),c("em",null,"jwt.verify"),o(" 这个方法去做一下验证。这个方法是 Node.js 的 jsonwebtoken 这个包里提供的，在其它的应用框架或者系统里，你可能会找到类似的方法来验证 JWT。")],-1),Q=c("p",null,"打开项目的 index.js 文件，里面添加几行代码：",-1),H=c("div",{class:"language-"},[c("pre",null,[c("code",null,"// 验证 Token\njwt.verify(token, 'bad secret', (error, decoded) => {\n  if (error) {\n    console.log(error.message)\n    return\n  }\n  console.log(decoded)\n})\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-60554"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// 验证 Token\njwt.verify(token, 'bad secret', (error, decoded) => {\n  if (error) {\n    console.log(error.message)\n    return\n  }\n  console.log(decoded)\n})\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-60554","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br")])],-1),q=c("p",null,[o("把要验证的 Token 数据，还有签发这个 Token 的时候用的那个密钥告诉 "),c("em",null,"verify"),o(" 这个方法，在一个回调里面有两个参数，"),c("em",null,"error"),o(" 表示错误，"),c("em",null,"decoded"),o(" 是解码之后的 Token 数据。")],-1),X=c("p",null,"执行：",-1),K=c("div",{class:"language-"},[c("pre",null,[c("code",null,"node ~/desktop/jwt-demo/index.js\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-64383"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"node ~/desktop/jwt-demo/index.js\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-64383","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),Z=c("p",null,"输出：",-1),ee=c("div",{class:"language-"},[c("pre",null,[c("code",null,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlLCJpYXQiOjE1MjkwMzQ3MzMsImV4cCI6MTUyOTEyMTEzM30.swXojmu7VimFu3BoIgAxxpmm2J05dvD0HT3yu10vuqU\n\ninvalid signature\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-94130"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlLCJpYXQiOjE1MjkwMzQ3MzMsImV4cCI6MTUyOTEyMTEzM30.swXojmu7VimFu3BoIgAxxpmm2J05dvD0HT3yu10vuqU\n\ninvalid signature\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-94130","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br")])],-1),te=c("p",null,[o("注意输出了一个 invalid signature ，表示 Token 里的签名不对，这是因为我们组长 "),c("em",null,"verify"),o(" 方法提供的密钥并不是签发 Token 的时候用的那个密钥。这样修改一下：")],-1),ne=c("div",{class:"language-"},[c("pre",null,[c("code",null,"jwt.verify(token, secret, (error, decoded) => { ...\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-13166"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"jwt.verify(token, secret, (error, decoded) => { ...\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-13166","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),ce=c("p",null,"再次运行，会输出类似的数据：",-1),oe=c("div",{class:"language-"},[c("pre",null,[c("code",null,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlLCJpYXQiOjE1MjkwMzUzODYsImV4cCI6MTUyOTEyMTc4Nn0.mkNrt4TfcfmP22xd3C_GQn8qnUmlB39dKT9SpIBTBGI\n\n{ name: 'wanghao', admin: true, iat: 1529035386, exp: 1529121786 }\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-4119"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlLCJpYXQiOjE1MjkwMzUzODYsImV4cCI6MTUyOTEyMTc4Nn0.mkNrt4TfcfmP22xd3C_GQn8qnUmlB39dKT9SpIBTBGI\n\n{ name: 'wanghao', admin: true, iat: 1529035386, exp: 1529121786 }\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-4119","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br")])],-1),ae=c("h3",{id:"rs256-算法"},[c("a",{class:"header-anchor",href:"#rs256-算法","aria-hidden":"true"},"#"),o(" RS256 算法")],-1),ie=c("p",null,"默认签发还有验证 Token 的时候用的是 HS256 算法，这种算法需要一个密钥（密码）。我们还可以使用 RS256 算法签发与验证 JWT。这种方法可以让我们分离开签发与验证，签发时需要用一个密钥，验证时使用公钥，也就是有公钥的地方只能做验证，但不能签发 JWT。",-1),de=c("p",null,"在项目下面创建一个新的目录，里面可以存储即将生成的密钥与公钥文件。",-1),le=c("div",{class:"language-"},[c("pre",null,[c("code",null,"cd ~/desktop/jwt-demo\nmkdir config\ncd config\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-21038"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"cd ~/desktop/jwt-demo\nmkdir config\ncd config\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-21038","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br")])],-1),se=c("h4",{id:"密钥"},[c("a",{class:"header-anchor",href:"#密钥","aria-hidden":"true"},"#"),o(" 密钥")],-1),me=c("p",null,"先生成一个密钥文件：",-1),re=c("div",{class:"language-"},[c("pre",null,[c("code",null,"ssh-keygen -t rsa -b 2048 -f private.key\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-99650"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"ssh-keygen -t rsa -b 2048 -f private.key\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-99650","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),pe=c("h4",{id:"公钥"},[c("a",{class:"header-anchor",href:"#公钥","aria-hidden":"true"},"#"),o(" 公钥")],-1),ye=c("p",null,"基于上面生成的密钥，再去创建一个对应的公钥：",-1),ue=c("div",{class:"language-"},[c("pre",null,[c("code",null,"openssl rsa -in private.key -pubout -outform PEM -out public.key\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-19622"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"openssl rsa -in private.key -pubout -outform PEM -out public.key\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-19622","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),be=c("h3",{id:"签发-jwtrs256-算法"},[c("a",{class:"header-anchor",href:"#签发-jwtrs256-算法","aria-hidden":"true"},"#"),o(" 签发 JWT（RS256 算法）")],-1),he=c("p",null,"用 RS256 算法签发 JWT 的时候，需要从文件系统上读取创建的密钥文件里的内容。",-1),ke=c("div",{class:"language-"},[c("pre",null,[c("code",null,"const fs = require('fs')\n\n// 获取签发 JWT 时需要用的密钥\nconst privateKey = fs.readFileSync('./config/private.key')\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-70655"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const fs = require('fs')\n\n// 获取签发 JWT 时需要用的密钥\nconst privateKey = fs.readFileSync('./config/private.key')\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-70655","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br")])],-1),fe=c("p",null,"签发仍然使用 jwt.sign 方法，只不过在选项参数里特别说明一下使用的算法是 RS256：",-1),Ce=c("div",{class:"language-"},[c("pre",null,[c("code",null,"// 签发 Token\nconst tokenRS256 = jwt.sign(payload, privateKey, { algorithm: 'RS256' })\n\n// 输出签发的 Token\nconsole.log('RS256 算法：', tokenRS256)\n"),c("div",{class:"m-mdic-copy-wrapper"},[c("div",{class:"u-mdic-copy-notify",id:"j-notify-1629558771327-70641"},"复制成功"),c("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"// 签发 Token\nconst tokenRS256 = jwt.sign(payload, privateKey, { algorithm: 'RS256' })\n\n// 输出签发的 Token\nconsole.log('RS256 算法：', tokenRS256)\n","data-mdic-attach-content":"copyright | [artiely]","data-mdic-notify-id":"j-notify-1629558771327-70641","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"复制")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br")])],-1);i.render=function(n,c,o,a,i,ge){return e(),t("div",null,[d,l,s,m,r,p,y,u,b,h,k,f,C,g,v,I,T,j,w,J,x,N,E,W,$,A,F,M,S,U,_,D,P,V,O,B,z,L,R,Y,G,Q,H,q,X,K,Z,ee,te,ne,ce,oe,ae,ie,de,le,se,me,re,pe,ye,ue,be,he,ke,fe,Ce])};export default i;export{a as __pageData};
